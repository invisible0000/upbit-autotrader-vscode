# 🎯 Trading Variables DB Migration GUI Tool

매매 변수 데이터베이스 마이그레이션을 위한 GUI 도구입니다.

## 📋 주요 기능

### 1. 📁 DB 선택 & 현재 상태
- DB 파일 선택 (기본 경로 자동 감지)
- 기존 DB 구조 및 데이터 분석
- 테이블 정보 및 레코드 수 표시

### 2. 📊 변수 & 파라미터 조회
- 카테고리별 변수 목록 표시
- 파라미터 상세 정보 조회
- 활성/비활성 상태 필터링
- 통계 정보 제공

### 3. 🔍 마이그레이션 미리보기
- 변경사항 상세 분석
- 테이블 구조 변경 사항 검토
- 데이터 마이그레이션 계획 확인
- 리스크 분석 및 대응 방안

### 4. 🚀 마이그레이션 실행
- 체크리스트 기반 안전한 실행
- 실시간 진행 상황 모니터링
- 테스트 모드 지원
- 상세한 실행 로그

### 5. 💾 백업 관리
- 정밀한 백업 파일명 (`_bck_20250730130431` 형식)
- 백업 파일 검증 및 복원
- 백업 내보내기/삭제 기능
- 안전한 복원 프로세스

## 🚀 사용 방법

### 실행
```bash
cd upbit_auto_trading\utils\trading_variables\gui_variables_DB_migration_util
python run_gui_trading_variables_DB_migration.py
```

### 단계별 사용법

#### 1단계: DB 선택
1. **📁 DB 선택 & 현재 상태** 탭에서 시작
2. "🏠 기본 경로 사용" 버튼으로 자동 감지 또는 "📂 DB 파일 선택"으로 수동 선택
3. DB 정보 및 테이블 구조 확인

#### 2단계: 현재 변수 확인
1. **📊 변수 & 파라미터 조회** 탭으로 이동
2. 카테고리별 필터링으로 변수 목록 확인
3. 개별 변수 선택하여 파라미터 상세 정보 조회

#### 3단계: 마이그레이션 계획 검토
1. **🔍 마이그레이션 미리보기** 탭에서 변경사항 분석
2. "🔍 변경사항 분석" 버튼 클릭
3. 테이블 변경, 데이터 영향, 호환성 분석 결과 검토
4. 리스크 수준 및 대응 방안 확인

#### 4단계: 마이그레이션 실행
1. **🚀 마이그레이션 실행** 탭에서 체크리스트 완료
2. 백업 파일명 확인 (자동 생성: `settings_bck_YYYYMMDD_HHMMSS.sqlite3`)
3. 테스트 모드로 먼저 실행 권장
4. 실제 마이그레이션 실행
5. 실시간 로그 및 진행 상황 모니터링

#### 5단계: 백업 관리
1. **💾 백업 관리** 탭에서 생성된 백업 확인
2. 백업 파일 검증 및 상태 확인
3. 필요시 백업에서 복원 또는 내보내기

## 🛡️ 안전 기능

### 백업 시스템
- **정밀한 타임스탬프**: `_bck_20250730130431` 형식으로 절대 겹치지 않음
- **자동 백업**: 마이그레이션 실행 전 자동 백업 생성
- **안전 백업**: 복원 시 현재 DB의 추가 백업 생성
- **백업 검증**: 파일 무결성 및 DB 구조 검증

### 실행 안전장치
- **체크리스트**: 필수 항목 확인 후 실행 가능
- **확인 다이얼로그**: 중요한 작업 전 재확인
- **테스트 모드**: 실제 변경 없이 시뮬레이션
- **진행 취소**: 실행 중 안전한 취소 기능

### 호환성 보장
- **100% 기존 코드 호환**: `variable_definitions.py` 등 기존 코드와 완전 호환
- **네임스페이스 분리**: `tv_` 접두사로 레거시와 분리
- **점진적 마이그레이션**: 단계별 안전한 업그레이드

## 📁 파일 구조

```
gui_variables_DB_migration_util/
├── main_gui.py                    # 메인 GUI 애플리케이션
├── run_gui.py                     # 실행 스크립트
├── README.md                      # 사용 설명서
└── components/                    # GUI 컴포넌트
    ├── __init__.py               # 컴포넌트 패키지 초기화
    ├── db_selector.py            # DB 선택 컴포넌트
    ├── variables_viewer.py       # 변수 조회 컴포넌트  
    ├── migration_preview.py      # 마이그레이션 미리보기
    ├── migration_executor.py     # 마이그레이션 실행기
    └── backup_manager.py         # 백업 관리 컴포넌트
```

## 🔧 기술 사양

### 필요 패키지
- Python 3.7+
- tkinter (Python 표준 라이브러리)
- sqlite3 (Python 표준 라이브러리)

### 지원 기능
- **멀티스레드**: 백그라운드 마이그레이션으로 UI 반응성 유지
- **실시간 로그**: 색상 코딩된 실행 로그
- **진행률 표시**: 시각적 진행 상황 모니터링
- **예외 처리**: 포괄적인 오류 처리 및 복구

## ⚠️ 주의사항

1. **백업 필수**: 마이그레이션 전 반드시 백업이 생성됩니다
2. **애플리케이션 종료**: 마이그레이션 실행 전 관련 프로그램 종료 권장
3. **충분한 디스크 공간**: 백업 파일을 위한 여유 공간 확보
4. **테스트 모드 활용**: 중요한 DB의 경우 테스트 모드로 먼저 확인

## 🎯 사용 시나리오

### 신규 사용자
1. 기본 경로 사용으로 DB 자동 감지
2. 변수 조회로 현재 상태 파악
3. 테스트 모드로 마이그레이션 시뮬레이션
4. 실제 마이그레이션 실행

### 고급 사용자
1. 수동 DB 선택으로 특정 파일 작업
2. 마이그레이션 미리보기로 상세 분석
3. 백업 관리로 다양한 백업 버전 관리
4. 필요시 선택적 백업 복원

## 🆘 문제 해결

### 일반적인 문제
- **모듈 import 오류**: Python 경로 및 패키지 설치 확인
- **DB 접근 오류**: 파일 권한 및 다른 프로그램의 DB 사용 확인
- **백업 생성 실패**: 디스크 공간 및 쓰기 권한 확인

### 복구 방법
- **마이그레이션 실패**: 자동 생성된 백업에서 복원
- **DB 손상**: 백업 관리 탭에서 이전 백업으로 복원
- **설정 초기화**: 새 DB 생성 후 기본 스키마 적용

---

💡 **팁**: 중요한 데이터가 있는 경우 테스트 모드를 먼저 실행하여 안전성을 확인하세요!
