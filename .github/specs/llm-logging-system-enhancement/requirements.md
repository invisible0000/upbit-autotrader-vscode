# LLM 에이전트 로깅 시스템 개선 요구사항

## 소개

현재 스마트 로깅 시스템 v3.1이 구현되어 있지만, LLM 에이전트가 실시간으로 애플리케이션 상태를 파악하고 효율적으로 문제를 해결하는 데 한계가 있습니다. 터미널 출력과 로그 파일이 분리되어 있고, LLM이 소비하기 적합한 구조화된 정보가 부족하여 사용자가 여전히 수동으로 터미널 출력을 복사해야 하는 상황입니다.

## 현재 문제점

1. **터미널 출력 불일치**: 스마트 로깅과 터미널 출력이 분리됨
2. **LLM_REPORT 누락**: 구조화된 보고가 실제 로그에 기록되지 않음
3. **실시간 접근성 부족**: LLM 에이전트가 실시간으로 상태를 파악하기 어려움
4. **워닝 정보 손실**: 중요한 경고 정보가 구조화되지 않아 분석 어려움

## 요구사항

### 요구사항 1: 실시간 LLM 브리핑 시스템

**사용자 스토리:** LLM 에이전트로서 애플리케이션 실행 시 현재 상태와 문제점을 즉시 파악하여 효율적으로 문제를 해결하고 싶습니다.

#### 수용 기준

1. WHEN 애플리케이션이 실행되면 THEN LLM 에이전트용 실시간 브리핑 파일이 자동 생성되어야 합니다
2. WHEN 시스템 상태가 변경되면 THEN 브리핑 파일이 1초 이내에 업데이트되어야 합니다
3. WHEN 워닝이나 에러가 발생하면 THEN 우선순위별로 구조화된 문제 리스트가 생성되어야 합니다
4. WHEN LLM 에이전트가 브리핑을 확인하면 THEN 다음 해결 액션이 명확히 제시되어야 합니다
5. WHEN 시스템 상태가 변경되면 THEN JSON 형태의 구조화된 상태 정보가 제공되어야 합니다

### 요구사항 2: 터미널 통합 로깅 시스템

**사용자 스토리:** 개발자로서 터미널에서 보는 모든 로그가 LLM 에이전트도 동일하게 접근할 수 있기를 원합니다.

#### 수용 기준

1. WHEN 터미널에 로그가 출력되면 THEN 동일한 내용이 LLM 로그에도 기록되어야 합니다
2. WHEN WARNING이나 ERROR가 터미널에 출력되면 THEN 구조화된 형태로 LLM 로그에 저장되어야 합니다
3. WHEN 스마트 로깅이 활성화되면 THEN 터미널과 파일 로그의 내용이 100% 일치해야 합니다
4. WHEN LLM_REPORT가 생성되면 THEN 터미널에도 동시에 표시되어야 합니다
5. WHEN 로깅 레벨이 변경되면 THEN 터미널과 파일 모두에 즉시 반영되어야 합니다

### 요구사항 3: 구조화된 LLM_REPORT 시스템 강화

**사용자 스토리:** LLM 에이전트로서 각 컴포넌트의 상태 변화를 구조화된 데이터로 받아 정확한 분석을 하고 싶습니다.

#### 수용 기준

1. WHEN 시스템 컴포넌트가 초기화되면 THEN Operation, Status, Details가 포함된 구조화된 보고가 생성되어야 합니다
2. WHEN 에러가 발생하면 THEN 에러 타입, 영향 범위, 해결 방안이 포함된 보고가 생성되어야 합니다
3. WHEN MVP 패턴 관련 동작이 발생하면 THEN MVP 전용 Operation 태그로 분류되어야 합니다
4. WHEN DI Container 문제가 발생하면 THEN 누락된 컴포넌트와 폴백 방식이 명시되어야 합니다
5. WHEN 성능 지표가 측정되면 THEN 시간, 메모리, 리소스 사용량이 구조화되어 기록되어야 합니다

### 요구사항 4: LLM 에이전트 자동 분석 대시보드

**사용자 스토리:** LLM 에이전트로서 복잡한 로그를 분석하지 않고도 현재 상황을 한눈에 파악할 수 있는 대시보드가 필요합니다.

#### 수용 기준

1. WHEN 애플리케이션이 실행되면 THEN `logs/llm_agent_dashboard.md` 파일이 실시간으로 생성되어야 합니다
2. WHEN 문제가 발생하면 THEN 우선순위별 문제 목록과 해결 방안이 자동 생성되어야 합니다
3. WHEN 시스템 상태가 변경되면 THEN 상태 요약이 시각적으로 표시되어야 합니다 (✅, ⚠️, ❌)
4. WHEN 성능 메트릭이 수집되면 THEN 핵심 지표가 대시보드에 표시되어야 합니다
5. WHEN LLM 에이전트가 분석을 완료하면 THEN 분석 결과와 추천 액션이 대시보드에 업데이트되어야 합니다

### 요구사항 5: 터미널 출력 캡처 및 구조화

**사용자 스토리:** 사용자로서 터미널에 출력되는 모든 정보가 LLM 에이전트에게 자동으로 전달되어 수동 복사가 필요 없기를 원합니다.

#### 수용 기준

1. WHEN 터미널에 WARNING이 출력되면 THEN 정규표현식으로 파싱하여 구조화된 데이터로 변환되어야 합니다
2. WHEN 터미널에 상태 메시지가 출력되면 THEN 메시지 타입별로 분류되어 저장되어야 합니다
3. WHEN 진행률이 터미널에 표시되면 THEN 수치가 추출되어 JSON 형태로 저장되어야 합니다
4. WHEN 터미널 출력이 캡처되면 THEN 타임스탬프와 함께 순서대로 저장되어야 합니다
5. WHEN 캡처된 데이터가 누적되면 THEN 자동으로 요약 및 패턴 분석이 수행되어야 합니다

### 요구사항 6: 효율적 LLM-사용자 워크플로우

**사용자 스토리:** 사용자로서 문제 발생 시 LLM 에이전트가 자동으로 분석하고 해결 방안을 제시하여 빠르게 문제를 해결하고 싶습니다.

#### 수용 기준

1. WHEN 문제가 발생하면 THEN LLM 에이전트가 자동으로 진단 보고서를 생성해야 합니다
2. WHEN 진단이 완료되면 THEN 사용자에게 명확한 해결 방안과 예상 시간을 제시해야 합니다
3. WHEN 사용자가 수정을 승인하면 THEN LLM 에이전트가 타겟팅된 수정을 실행해야 합니다
4. WHEN 수정이 완료되면 THEN 결과를 검증하고 추가 조치 필요 여부를 알려야 합니다
5. WHEN 워크플로우가 완료되면 THEN 전체 과정이 로그에 기록되어 학습 데이터로 활용되어야 합니다

### 요구사항 7: 현재 워닝 문제 해결

**사용자 스토리:** 개발자로서 현재 발생하는 Application Container 및 ThemeService 관련 워닝을 LLM 에이전트가 자동으로 분석하고 해결 방안을 제시받고 싶습니다.

#### 수용 기준

1. WHEN "Application Container를 찾을 수 없음" 워닝이 발생하면 THEN 관련 DI Container 초기화 로직이 분석되어야 합니다
2. WHEN "ThemeService metaclass 충돌" 에러가 발생하면 THEN PyQt6과 DI Container 호환성 문제가 진단되어야 합니다
3. WHEN MVP 패턴 제한적 동작이 감지되면 THEN 영향 범위와 해결 우선순위가 제시되어야 합니다
4. WHEN 폴백 모드가 활성화되면 THEN 성능 영향도와 개선 방안이 분석되어야 합니다
5. WHEN 워닝 해결이 완료되면 THEN 시스템 안정성 개선 효과가 측정되고 보고되어야 합니다

### 요구사항 8: 로깅 성능 최적화

**사용자 스토리:** 개발자로서 강화된 로깅 시스템이 애플리케이션 성능에 미치는 영향을 최소화하면서도 충분한 정보를 제공받고 싶습니다.

#### 수용 기준

1. WHEN 로깅이 활성화되면 THEN 애플리케이션 실행 시간이 10% 이상 증가하지 않아야 합니다
2. WHEN LLM_REPORT가 생성되면 THEN UI 응답성에 영향을 주지 않아야 합니다
3. WHEN 로그 파일이 커지면 THEN 자동으로 로테이션되어 디스크 공간을 절약해야 합니다
4. WHEN 개발 모드가 아니면 THEN 로깅 레벨이 자동으로 최적화되어야 합니다
5. WHEN 메모리 사용량이 증가하면 THEN 실시간으로 모니터링되고 임계값 초과 시 경고해야 합니다

### 요구사항 9: 환경변수 기반 로깅 제어 강화

**사용자 스토리:** 개발자로서 다양한 상황에서 환경변수를 통해 로깅 동작을 세밀하게 제어하고 싶습니다.

#### 수용 기준

1. WHEN `UPBIT_LLM_BRIEFING_ENABLED=true`로 설정하면 THEN 실시간 브리핑 시스템이 활성화되어야 합니다
2. WHEN `UPBIT_TERMINAL_CAPTURE=true`로 설정하면 THEN 터미널 출력 캡처가 활성화되어야 합니다
3. WHEN `UPBIT_AUTO_DIAGNOSIS=true`로 설정하면 THEN 자동 진단 시스템이 동작해야 합니다
4. WHEN `UPBIT_LLM_DASHBOARD_UPDATE_INTERVAL=5`로 설정하면 THEN 대시보드가 5초마다 업데이트되어야 합니다
5. WHEN 프로덕션 모드에서는 THEN 성능에 영향을 주는 로깅 기능이 자동으로 비활성화되어야 합니다

### 요구사항 10: 로깅 시스템 테스트 및 검증

**사용자 스토리:** 개발자로서 개선된 로깅 시스템이 모든 상황에서 안정적으로 동작하는지 검증하고 싶습니다.

#### 수용 기준

1. WHEN 로깅 시스템 테스트를 실행하면 THEN 모든 로깅 경로가 정상 동작해야 합니다
2. WHEN LLM_REPORT 생성 테스트를 실행하면 THEN 모든 컴포넌트에서 올바른 형식으로 보고가 생성되어야 합니다
3. WHEN 터미널 캡처 테스트를 실행하면 THEN 다양한 출력 패턴이 정확히 파싱되어야 합니다
4. WHEN 브리핑 시스템 테스트를 실행하면 THEN 실시간 업데이트가 정상 동작해야 합니다
5. WHEN 성능 테스트를 실행하면 THEN 로깅으로 인한 성능 저하가 허용 범위 내에 있어야 합니다
