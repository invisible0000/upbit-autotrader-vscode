# 자산 스크리너 재설계 구현 계획

## 구현 전략

기존의 복잡한 스크리너를 완전히 제거하고, 단순하고 안정적인 새로운 스크리너를 단계별로 구현합니다. 각 단계에서 철저한 테스트를 통해 안정성을 확보합니다.

## 구현 태스크

- [x] 1. 기존 스크리너 시스템 완전 제거


  - 기존 asset_screening 관련 모든 파일 및 폴더 삭제
  - 메인 윈도우에서 스크리너 탭 제거
  - 관련 import 및 참조 정리
  - _요구사항: 1.1, 1.2, 1.3, 1.4_

- [x] 2. 효율적인 증분 데이터 수집기 구현




  - [x] 2.1 SimpleDataCollector 기본 구조 구현



    - 업비트 API 클라이언트 기본 구조 구현
    - 코인 목록 조회 기능 구현
    - 기본 오류 처리 및 재시도 로직 구현
    - _요구사항: 3.1, 3.2, 8.1, 8.2_

  - [x] 2.2 공유 DB 기존 데이터 확인 시스템 구현


    - 공유 시장 데이터 DB에서 기존 데이터 존재 여부 확인 기능 구현
    - 단일 코인-타임프레임당 단일 테이블 보장 로직 구현
    - 공유 테이블명 생성 규칙 구현 (candles_{symbol}_{timeframe})
    - 데이터 시간 범위 및 갭 분석 기능 구현
    - 수집 모드 결정 로직 구현 (full/incremental/cached)
    - _요구사항: 6.1, 6.2, 6.8_

  - [x] 2.3 증분 데이터 수집 및 공유 DB 병합 시스템 구현


    - 필요한 데이터 갭만 수집하는 로직 구현
    - 새 데이터를 공유 DB의 기존 데이터에 병합하는 기능 구현
    - 공유 DB 테이블에서 중복 데이터 제거 및 시간순 정렬 기능 구현
    - 공유 DB 앞쪽/뒤쪽 데이터 추가 기능 구현
    - 다른 기능과의 DB 공유 호환성 보장 구현
    - _요구사항: 6.3, 6.4, 6.5, 6.7, 6.8_

  - [x] 2.4 데이터 캐싱 및 공유 DB 최적화 시스템 구현


    - 메모리 기반 캐싱 구현
    - 캐시 만료 및 갱신 로직 구현
    - 동일 설정 재스크리닝 시 공유 DB 재활용 로직 구현
    - 공유 DB 접근 최적화 (인덱스, 쿼리 최적화)
    - _요구사항: 6.6, 7.3_

  - [x] 2.5 API 호출 최적화


    - 업비트 API 제한 준수 로직 구현
    - 불필요한 API 호출 방지 로직 구현
    - 배치 처리 및 동시 호출 수 제한 구현
    - _요구사항: 7.1, 7.2_

- [x] 3. 기본 분석 엔진 구현






  - [x] 3.1 SimpleScreener 클래스 생성


    - 기본 필터링 로직 구현 (가격, 거래량, 시가총액)
    - 필터 조건 검증 기능 구현
    - 결과 정렬 및 랭킹 기능 구현
    - _요구사항: 1.1, 1.2, 1.3, 1.4_

  - [x] 3.2 캔들차트 오버레이 지표 계산 구현


    - 단순이동평균(SMA) 계산 기능 구현 (5, 20, 60일)
    - 지수이동평균(EMA) 계산 기능 구현 (12, 26일)
    - 볼린저밴드 계산 기능 구현 (20일 기준)
    - 캔들차트에 오버레이 가능한 추세 지표만 포함
    - _요구사항: 2.1, 2.2_

  - [x] 3.3 점수 산정 시스템 구현


    - 각 지표별 점수 계산 로직 구현
    - 종합 점수 산정 알고리즘 구현
    - 추천 등급 분류 시스템 구현
    - _요구사항: 2.3, 2.4_

- [x] 4. UI 컴포넌트 구현 (좌우 1:3 레이아웃)





  - [x] 4.1 SimpleScreenerTab 메인 탭 구현


    - 좌우 1:3 분할 레이아웃 구현
    - 하위 위젯들 간의 시그널 연결
    - 전체 스크리닝 프로세스 제어 로직 구현
    - _요구사항: 1.1, 4.1_

  - [ ] 4.2 CoinListWidget 개선 구현 (좌측 상단)
    - 시장 콤보박스 기본값을 KRW로 설정
    - "시장:", 시장 콤보박스, "즐겨찾기만 보기"를 한 줄로 배치하여 공간 절약
    - 창 열릴 때 선택된 시장의 모든 코인 목록 자동 로드
    - 코인 심벌을 KRW-BTC 형식으로 시장 포함하여 표시
    - 즐겨찾기 체크박스 기능 구현
    - 즐겨찾기 코인 상위 표시 로직 구현
    - _요구사항: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7, 1.8_

  - [x] 4.3 ScreenSettingsWidget 구현 (좌측 중앙)


    - 스크롤 가능한 지표 선택 패널 구현
    - 유동성, 규모, RSI, MACD, 이동평균 옵션 구현
    - 3개 빠른 선택 버튼 구현
    - 협소한 공간에서의 스크롤 기능 구현
    - _요구사항: 2.1, 2.2, 2.3, 2.4_

  - [x] 4.4 ScreenControlWidget 구현 (좌측 하단)


    - 시작/중지 버튼 구현
    - 타임프레임 및 기간 설정 UI 구현
    - 투자 적절한 기본값 설정 구현
    - 진행바 및 상태 표시 구현 (전체/현재/심벌/남은시간)
    - 즐겨찾기 우선 처리 로직 구현
    - _요구사항: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7_

  - [x] 4.5 ResultsTableWidget 구현 (우측 상단)


    - 상단 한 줄 필터 기능 구현
    - 스크리닝 결과 테이블 구현
    - 열 제목 클릭 정렬 기능 구현
    - 즐겨찾기 코인 상위 유지 로직 구현
    - _요구사항: 4.1, 4.2, 4.3, 4.4, 4.5_

  - [x] 4.6 CoinChartWidget 구현 (우측 하단)


    - mplfinance 패키지를 사용한 캔들스틱 차트 구현
    - 거래량 서브플롯 구현
    - 이동평균선 오버레이 기능 구현 (SMA, EMA)
    - 볼린저밴드 오버레이 기능 구현
    - PyQt6에 matplotlib 위젯 임베드 구현
    - _요구사항: 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 5. 안전한 중지 및 오류 처리 구현





  - [x] 5.1 중지 기능 구현


    - 안전한 중지 로직 구현
    - 진행 중인 작업 정리 기능 구현
    - UI 상태 복원 기능 구현
    - _요구사항: 3.3, 3.4_

  - [x] 5.2 포괄적 오류 처리 구현


    - 네트워크 오류 처리 구현
    - 데이터 파싱 오류 처리 구현
    - 사용자 친화적 오류 메시지 구현
    - _요구사항: 6.1, 6.2, 6.3, 6.4_

  - [x] 5.3 복구 메커니즘 구현


    - 자동 재시도 로직 구현
    - 중단점 저장 및 복원 기능 구현
    - 부분 결과 보존 기능 구현
    - _요구사항: 6.4_

- [ ] 6. 데이터 내보내기 및 저장 기능 구현
  - [ ] 6.1 결과 내보내기 기능 구현
    - CSV 형식 내보내기 구현
    - Excel 형식 내보내기 구현
    - 사용자 정의 필드 선택 기능 구현
    - _요구사항: 4.4_

  - [ ] 6.2 설정 저장 및 로드 기능 구현
    - 필터 설정 저장 기능 구현
    - 즐겨찾기 설정 관리 기능 구현
    - 타임프레임/기간 기본값 저장 기능 구현
    - 기본 설정 복원 기능 구현
    - _요구사항: 4.6_

- [x] 7. 성능 최적화 및 리소스 관리





  - [x] 7.1 메모리 사용량 최적화


    - 메모리 사용량 모니터링 구현
    - 불필요한 데이터 자동 정리 구현
    - 대용량 데이터 처리 최적화 구현
    - _요구사항: 7.1, 7.3_

  - [x] 7.2 증분 수집 성능 최적화


    - 데이터 수집 효율성 모니터링 구현
    - DB 쿼리 최적화 구현
    - 캐시 히트율 최적화 구현
    - _요구사항: 6.5, 7.2_

- [x] 8. 통합 테스트 및 검증





  - [x] 8.1 단위 테스트 작성



    - 각 컴포넌트별 단위 테스트 작성
    - 모의 데이터를 사용한 테스트 구현
    - 오류 상황 테스트 케이스 작성
    - _요구사항: 모든 요구사항 검증_

  - [x] 8.2 통합 테스트 실행


    - 전체 워크플로우 테스트 실행
    - 실제 API를 사용한 소규모 테스트
    - 성능 및 안정성 테스트 실행
    - _요구사항: 모든 요구사항 검증_

  - [x] 8.3 사용자 시나리오 테스트


    - 실제 사용 시나리오 기반 테스트
    - 다양한 필터 조건 테스트
    - 오류 상황 대응 테스트
    - _요구사항: 모든 요구사항 검증_

- [x] 9. 메인 시스템 통합





  - [x] 9.1 메인 윈도우 통합


    - 새로운 스크리너 탭을 메인 윈도우에 추가
    - 네비게이션 바에 스크리너 메뉴 추가
    - 기존 시스템과의 호환성 확인
    - _요구사항: 4.1_

  - [x] 9.2 설정 시스템 통합


    - 전역 설정에 스크리너 설정 추가
    - API 키 설정과 연동
    - 사용자 환경 설정 저장
    - _요구사항: 4.1_

- [x] 10. 문서화 및 사용자 가이드 작성





  - [x] 10.1 기술 문서 작성


    - API 문서 작성
    - 아키텍처 문서 업데이트
    - 개발자 가이드 작성
    - _요구사항: 모든 요구사항_

  - [x] 10.2 사용자 가이드 작성


    - 스크리너 사용법 가이드 작성
    - 필터 설정 방법 안내
    - 문제 해결 가이드 작성
    - _요구사항: 4.1, 4.2, 4.3, 4.4_