# 자산 스크리너 재설계 요구사항 문서

## 소개

기존 스크리너의 복잡성과 불안정성 문제를 해결하기 위해 완전히 새로운 접근 방식으로 자산 스크리너를 재설계합니다. 단순성, 안정성, 사용성을 최우선으로 하여 개발합니다.

## UI 레이아웃 구조

스크리너 화면은 다음과 같은 6개 구성 요소로 이루어집니다:

### 전체 레이아웃
- **메인 분할**: 좌우 1:3 비율
- **좌측 영역**: 1열 3행 구조 (3:3:1 비율)
- **우측 영역**: 1열 2행 구조 (1:1 비율)

### 구성 요소
1. **코인 리스트** (좌측 1행): 시장별 필터링, 심벌/이름 표시, 즐겨찾기 기능
2. **스크린 설정** (좌측 2행): 지표 설정, 빠른 선택 버튼, 스크롤 가능
3. **스크린 제어** (좌측 3행): 시작/중지 버튼, 타임프레임/기간 설정, 진행바
4. **스크린 결과** (우측 1행): 결과 필터, 정렬 가능한 결과 테이블
5. **코인 차트** (우측 2행): 캔들차트, 거래량 서브플롯, 기술적 지표 표시

## 요구사항

### 요구사항 1: 코인 리스트 및 시장 필터링 시스템

**사용자 스토리:** 사용자로서 업비트에 상장된 코인들을 시장별로 필터링하고 즐겨찾기 관리를 하고 싶습니다.

#### 수용 기준
1. WHEN 사용자가 스크리너 탭에 접근하면 THEN 시스템은 좌측 상단에 업비트 코인 목록을 표시해야 합니다
2. WHEN 시스템이 초기화되면 THEN 시장 콤보박스의 기본값은 KRW로 설정되어야 합니다
3. WHEN 시장 필터 UI가 표시되면 THEN 시스템은 "시장:", 시장 콤보박스, "즐겨찾기만 보기" 체크박스를 한 줄로 배치하여 공간을 절약해야 합니다
4. WHEN 자산 스크리닝 창이 열리면 THEN 시스템은 선택된 시장의 모든 코인 목록을 읽어와서 표시해야 합니다
5. WHEN 사용자가 시장을 선택하면 THEN 시스템은 해당 시장의 코인만 필터링하여 표시해야 합니다
6. WHEN 코인 리스트가 표시되면 THEN 시스템은 각 코인의 심벌을 KRW-BTC 형식으로 시장을 명확히 구분해서 표시해야 합니다
7. WHEN 사용자가 코인을 즐겨찾기하면 THEN 시스템은 해당 코인을 필터와 관계없이 항상 상위에 표시해야 합니다
8. WHEN 즐겨찾기 코인이 있으면 THEN 시스템은 스크리닝 시 즐겨찾기 코인을 우선적으로 처리해야 합니다

### 요구사항 2: 스크린 설정 및 지표 선택 시스템

**사용자 스토리:** 사용자로서 자동매매에 유리한 유동성과 규모 등의 지표를 쉽게 설정하고 싶습니다.

#### 수용 기준
1. WHEN 사용자가 스크린 설정 영역에 접근하면 THEN 시스템은 좌측 중앙에 스크롤 가능한 설정 패널을 표시해야 합니다
2. WHEN 사용자가 지표를 선택하면 THEN 시스템은 유동성, 규모, RSI, MACD, 이동평균 등의 옵션을 제공해야 합니다
3. WHEN 사용자가 빠른 선택을 원하면 THEN 시스템은 3개의 사전 정의된 설정 버튼을 제공해야 합니다
4. WHEN 설정 내용이 많아지면 THEN 시스템은 협소한 공간에서도 스크롤을 통해 모든 옵션에 접근할 수 있어야 합니다
5. IF 분석 중 오류가 발생하면 THEN 시스템은 해당 코인을 건너뛰고 계속 진행해야 합니다

### 요구사항 3: 스크리닝 제어 및 진행 상태 관리 시스템

**사용자 스토리:** 사용자로서 스크리닝을 시작/중지하고 진행 상황을 실시간으로 모니터링하고 싶습니다.

#### 수용 기준
1. WHEN 사용자가 제어 영역에 접근하면 THEN 시스템은 좌측 하단에 시작/중지 버튼을 표시해야 합니다
2. WHEN 사용자가 스크리닝을 설정하면 THEN 시스템은 코인의 타임프레임과 기간을 지정할 수 있어야 합니다
3. WHEN 시스템이 초기화되면 THEN 시스템은 투자에 적절한 기본값(타임프레임, 기간)을 제공해야 합니다
4. WHEN 스크리닝이 시작되면 THEN 시스템은 진행바에 전체 코인 수, 현재 처리 중인 코인 수, 코인 심벌, 남은 시간을 표시해야 합니다
5. WHEN 즐겨찾기 코인이 있으면 THEN 시스템은 즐겨찾기 코인을 우선적으로 처리해야 합니다
6. WHEN 사용자가 중지 버튼을 누르면 THEN 시스템은 즉시 안전하게 중지되어야 합니다
7. WHEN 중지가 완료되면 THEN 시스템은 중지 전까지 처리된 결과를 올바르게 표현해야 합니다

### 요구사항 4: 스크리닝 결과 표시 및 필터링 시스템

**사용자 스토리:** 사용자로서 스크리닝 결과를 효과적으로 필터링하고 정렬하여 분석하고 싶습니다.

#### 수용 기준
1. WHEN 스크리닝 결과가 생성되면 THEN 시스템은 우측 상단에 결과 리스트를 표시해야 합니다
2. WHEN 사용자가 결과를 필터링하려면 THEN 시스템은 결과 리스트 상부에 한 줄 필터 기능을 제공해야 합니다
3. WHEN 결과가 표시되면 THEN 시스템은 스크리닝된 코인들과 계산값들을 명확하게 표시해야 합니다
4. WHEN 사용자가 열 제목을 클릭하면 THEN 시스템은 해당 열을 기준으로 오름차순/내림차순 정렬해야 합니다
5. WHEN 정렬이 수행되어도 THEN 시스템은 즐겨찾기 코인을 항상 상위에 유지해야 합니다
6. WHEN 사용자가 결과를 내보내기하면 THEN 시스템은 CSV 또는 Excel 형태로 저장해야 합니다

### 요구사항 5: 코인 차트 표시 및 캔들 오버레이 지표 시스템

**사용자 스토리:** 사용자로서 선택한 코인의 차트를 보고 캔들에 오버레이되는 추세 지표를 확인하고 싶습니다.

#### 수용 기준
1. WHEN 사용자가 결과 리스트에서 코인을 선택하면 THEN 시스템은 우측 하단에 해당 코인의 차트를 표시해야 합니다
2. WHEN 차트가 표시되면 THEN 시스템은 mplfinance를 사용한 캔들스틱 차트를 메인 플롯으로 표시해야 합니다
3. WHEN 차트가 표시되면 THEN 시스템은 거래량을 서브플롯으로 표시해야 합니다
4. WHEN 기술적 지표가 선택되면 THEN 시스템은 이동평균선(SMA, EMA)을 캔들차트에 오버레이해야 합니다
5. WHEN 볼린저밴드가 선택되면 THEN 시스템은 상단/하단 밴드를 캔들차트에 오버레이해야 합니다
6. WHEN 지표가 표시되면 THEN 시스템은 MACD 등 별도 서브플롯이 필요한 지표는 제외해야 합니다

### 요구사항 6: 효율적인 증분 데이터 수집 및 공유 DB 시스템

**사용자 스토리:** 사용자로서 스크리닝을 여러 번 수행할 때 공유 DB의 기존 데이터를 활용하여 빠르고 효율적으로 작동하기를 원합니다.

#### 수용 기준
1. WHEN 스크리닝이 시작되면 THEN 시스템은 공유 시장 데이터 DB에서 기존 데이터를 먼저 확인해야 합니다
2. WHEN 시장 데이터 DB를 관리할 때 THEN 시스템은 단일 코인-타임프레임 조합마다 하나의 테이블만 유지해야 합니다
3. WHEN 기존 데이터가 있으면 THEN 시스템은 새로운 데이터만 수집하여 기존 공유 DB에 병합해야 합니다
4. WHEN 기간이 연장되면 THEN 시스템은 연장된 기간만큼의 데이터만 추가로 수집해야 합니다
5. WHEN 시간이 지난 후 스크리닝하면 THEN 시스템은 최신 데이터만 수집하여 공유 DB 앞쪽에 추가해야 합니다
6. WHEN 같은 설정으로 재스크리닝하면 THEN 시스템은 공유 DB 데이터를 재활용하여 즉시 분석을 시작해야 합니다
7. WHEN 데이터 병합이 완료되면 THEN 시스템은 중복 데이터를 제거하고 시간순으로 정렬해야 합니다
8. WHEN 다른 기능에서 동일한 코인-타임프레임 데이터가 필요하면 THEN 시스템은 동일한 공유 DB 테이블을 사용해야 합니다

### 요구사항 7: 성능 최적화 및 리소스 관리

**사용자 스토리:** 사용자로서 시스템이 과도한 리소스를 사용하지 않고 효율적으로 작동하기를 원합니다.

#### 수용 기준
1. WHEN 대량의 코인을 분석할 때 THEN 시스템은 메모리 사용량을 적정 수준으로 유지해야 합니다
2. WHEN API 호출을 수행할 때 THEN 시스템은 업비트 API 제한을 준수해야 합니다
3. WHEN 분석이 완료되면 THEN 시스템은 불필요한 데이터를 정리해야 합니다
4. IF 시스템 리소스가 부족하면 THEN 시스템은 사용자에게 알리고 안전하게 중지해야 합니다

### 요구사항 8: 오류 처리 및 복구

**사용자 스토리:** 사용자로서 오류가 발생해도 시스템이 안정적으로 복구되기를 원합니다.

#### 수용 기준
1. WHEN 네트워크 오류가 발생하면 THEN 시스템은 자동으로 재시도해야 합니다
2. WHEN 데이터 파싱 오류가 발생하면 THEN 시스템은 해당 데이터를 건너뛰고 계속 진행해야 합니다
3. WHEN 심각한 오류가 발생하면 THEN 시스템은 사용자에게 명확한 오류 메시지를 표시해야 합니다
4. WHEN 오류가 해결되면 THEN 시스템은 중단된 지점부터 재개할 수 있어야 합니다