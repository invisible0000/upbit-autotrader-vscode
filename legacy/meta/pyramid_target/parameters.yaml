# ═══════════════════════════════════════════════════════════════
# 🎯 META_PYRAMID_TARGET (피라미딩) - 매개변수 정의
# ═══════════════════════════════════════════════════════════════
# 대응 테이블: tv_variable_parameters
# 지표 ID: META_PYRAMID_TARGET
# ═══════════════════════════════════════════════════════════════

# 매개변수 목록 - UnifiedParameter 지원 구조
parameters:
  # ═══════════════════════════════════════════════════════════
  # 🎯 UnifiedParameter 구조 - 외부 제어형 상태 변수 지원
  # ═══════════════════════════════════════════════════════════

  # ─────────────────────────────────────────────────────────────
  # 📊 계산 방식 (Calculation Method) - 필수 매개변수
  # ─────────────────────────────────────────────────────────────
  - name: "calculation_method"
    type: "enum"
    default_value: "entry_price_percent"
    required: true
    min_value: null
    max_value: null
    enum_values:
      - "average_price_percent"      # 평단값 퍼센트포인트 (%p) - 평단가 기준
      - "entry_price_percent"        # 진입값 퍼센트포인트 (%p) - 진입가 기준
      - "static_value_offset"        # 정적차이 (원화/수치) - 절대값 차이
      - "percentage_of_tracked"      # 극값 비율퍼센트 (%) - 최고/최저점 대비
    display_name: "계산 방식"
    description: "피라미딩 계산 방식 (평단가%p/진입가%p/정적차이/극값비율%)"
    display_order: 1

  # ─────────────────────────────────────────────────────────────
  # 📈 추적 기본변수 (Tracked Variable) - 필수 매개변수
  # ─────────────────────────────────────────────────────────────
  - name: "tracked_variable"
    type: "enum"
    default_value: "CURRENT_PRICE"
    required: true
    min_value: null
    max_value: null
    enum_values:
      - "CURRENT_PRICE"     # 현재가 (실시간)
      - "RSI"               # RSI 지표
      - "MACD"              # MACD 지표
      - "BOLLINGER_UPPER"   # 볼린저 상단
      - "BOLLINGER_LOWER"   # 볼린저 하단
      - "SMA_20"            # 20일 단순이평선
      - "EMA_12"            # 12일 지수이평선
    display_name: "추적 기본변수"
    description: "피라미딩 기준이 될 기본 변수 선택 (현재가, 지표 등)"
    display_order: 2

  # ─────────────────────────────────────────────────────────────
  # � 계산값 (Value) - 필수 매개변수
  # ─────────────────────────────────────────────────────────────
  - name: "value"
    type: "decimal"
    default_value: "5.0"
    required: true
    min_value: "-50.0"
    max_value: "100.0"
    enum_values: null
    display_name: "계산값"
    description: "계산에 사용될 값 (퍼센트: 5.0=5% 수익, 원화: 1000=1000원)"
    display_order: 3

  # ─────────────────────────────────────────────────────────────
  # 🎯 추적 방향 (Trail Direction) - 필수 매개변수
  # ─────────────────────────────────────────────────────────────
  - name: "trail_direction"
    type: "enum"
    default_value: "up"
    required: true
    min_value: null
    max_value: null
    enum_values:
      - "up"      # 상향 추적 (불타기 - 수익 시 추가 매수)
      - "down"    # 하향 추적 (물타기 - 손실 시 추가 매수)
    display_name: "추적 방향"
    description: "피라미딩 방향 (UP: 불타기-수익시매수, DOWN: 물타기-손실시매수)"
    display_order: 4

  # ─────────────────────────────────────────────────────────────
  # 🔢 최대 횟수 (Max Count) - 필수 매개변수
  # ─────────────────────────────────────────────────────────────
  - name: "max_pyramid_count"
    type: "integer"
    default_value: "3"
    required: true
    min_value: "1"
    max_value: "10"
    enum_values: null
    display_name: "최대 횟수"
    description: "최대 피라미딩 횟수 (1-10회, 소진 시 비활성화)"
    display_order: 5

  # ─────────────────────────────────────────────────────────────
  # ⚠️ 타임프레임 (Timeframe) - 추적변수 따름 (정보용)
  # ─────────────────────────────────────────────────────────────
  - name: "timeframe"
    type: "enum"
    default_value: "follow_tracked_variable"
    required: false
    min_value: null
    max_value: null
    enum_values:
      - "follow_tracked_variable"    # 추적 변수의 타임프레임 따름 (기본)
      - "realtime"                   # 실시간 (현재가용)
    display_name: "타임프레임"
    description: "추적 변수의 타임프레임을 따름 (별도 설정 불필요)"
    display_order: 6
