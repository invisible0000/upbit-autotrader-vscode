## 캔들 데이터 제공자 기능 기획

### 요구 기능
#### 핵심 기능 (최소 구현)
1. **캔들 데이터 수집**: 업비트 API에서 캔들 데이터 조회
2. **캔들 데이터 저장**: SQLite DB에 안전하게 저장
3. **캔들 데이터 제공**: 서브시스템에게 데이터 제공
4. **기본 캐시**: 중복 요청 방지를 위한 간단한 메모리 캐시

#### 부가정보
- datetime.now(timezone.utc) 기준 사용 환경 시간 따름(사용자 책임)


### 동작 상세
- direct 아니라면 모든 요청은 to를 가지도록 변환 (**필요성 검토**)
- 기본적으로 청크 기능 기반 (count 200개 이하면 청크가 1개)
- 시스템 요청 정보를 동작 중 관리
	- request_info.symbol 
	- request_info.timeframe 
	- request_info.count 
	- request_info.start 
	- request_info.end (request_info.count 와 request_info.end 는 동시 불가)
- 요청은 nomalize해서 정렬된 시간으로 사용

#### 요청 nomalize
- 모든 요청은 to를 가지도록 정규화
- 정렬된 시간으로 정규화
- to 요청이 없어도 datetime.now(timezone.utc) 로 start_time생성
- time_utils.py을 기반으로 200개 단위 청크로 만듬
- 청크 별로 start_time, end_time 을 가짐

#### 청크 처리
- 오버랩 분석기는 청크별 요청에 대해 
- 데이터 연속성을 위해 실제 업비트 응답의 마지막 candle_date_time_utc 를 확인
	1. 응답의 마지막 candle_date_time_utc - dt == 다음 청크 start_time
	2. 다르면, 차이 만큼 다음 청크의 start_time 과 end_time을 조정
- 모든 청크 처리 후 모든 청크의 시작과 끝 범위에 db 데이터 갯수와 카운트 갯수를 비교(초반에만 검증, 안정되면 삭제)

### get_candles 파라미터 별 동작
#### count (200개 이하, 청크 1개)
1. 청크 기반 (direct 옵션 없으면 기본)
	- 현재 시간을 start_time
	- 오버랩 분석기 사용
	- 
2. 다이렉트 요청(**필요성 검토**)
	- 200개 이하여야 함 
	- direct = true 가 옵션으로 요청되야함 (기본값 false)
	- 오버랩 분석기 사용안함
	- 바로 rest api로 요청
	- db에 insert or ignore로 저장(candle repository에 기능 활용)

#### count, to
- 청크 기반
- to 를 start_time으로하여 count를 이용하여 end_time 계산

#### to, end
- to 를 start_time end 를 count를 end_time 으로 이용하여 count 계산

#### end
- datetime.now(timezone.utc) 를 start_time으로 end를 end_time 으로 이용하여 count 계산