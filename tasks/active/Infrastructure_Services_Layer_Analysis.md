# ðŸ“‹ Infrastructure Layer ì„œë¹„ìŠ¤ ë°°ì¹˜ ì ì ˆì„± ê²€í† 

## ðŸŽ¯ ë¶„ì„ ëŒ€ìƒ: upbit_auto_trading/infrastructure/services/ í´ë”

### ðŸ“Š **ì„œë¹„ìŠ¤ë³„ Infrastructure Layer ì ì ˆì„± í‰ê°€**

---

## âœ… **Infrastructure Layerì— ì ì ˆí•œ ì„œë¹„ìŠ¤ë“¤ (ì™¸ë¶€ ì—°ê²° ê´€ì )**

### **1. ðŸ”‘ api_key_service.py** - â­â­â­â­â­ **ì™„ë²½ ì í•©**

```python
# âœ… ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬: cryptography.fernet (ì™¸ë¶€ ì•”í˜¸í™” ì‹œìŠ¤í…œ)
# âœ… ì™¸ë¶€ ì €ìž¥ì†Œ: íŒŒì¼ ì‹œìŠ¤í…œ (OS ë ˆë²¨ ë³´ì•ˆ ì €ìž¥ì†Œ)
# âœ… ì™¸ë¶€ ë³´ì•ˆ ì •ì±…: OS ë©”ëª¨ë¦¬ ê´€ë¦¬, GCì™€ ì—°ë™
# âœ… í•˜ë“œì›¨ì–´ ì˜ì¡´: ì•”í˜¸í™” í‚¤ ìƒì„±, ë³´ì•ˆ ì—”íŠ¸ë¡œí”¼
```

**Infrastructure ë°°ì¹˜ ê·¼ê±° (ì™¸ë¶€ ì—°ê²° ê´€ì )**:

- **ì™¸ë¶€ ì•”í˜¸í™” ë¼ì´ë¸ŒëŸ¬ë¦¬**: cryptographyëŠ” ì™¸ë¶€ ë³´ì•ˆ ì‹œìŠ¤í…œ
- **ì™¸ë¶€ íŒŒì¼ ì‹œìŠ¤í…œ**: OS ë ˆë²¨ ë³´ì•ˆ ì €ìž¥ì†Œì™€ ì—°ë™
- **ì™¸ë¶€ í•˜ë“œì›¨ì–´**: ë³´ì•ˆ ì—”íŠ¸ë¡œí”¼, ë©”ëª¨ë¦¬ ë³´ì•ˆ ì •ì±…

### **2. ðŸ—„ï¸ database_connection_service.py** - â­â­â­â­â­ **ì™„ë²½ ì í•©**

```python
# âœ… ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™: SQLite3 ë°ì´í„°ë² ì´ìŠ¤
# âœ… ë¦¬ì†ŒìŠ¤ ê´€ë¦¬: ì—°ê²° í’€, Circuit Breaker íŒ¨í„´
# âœ… ì¸í”„ë¼ ê´€ì‹¬ì‚¬: ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§, Health Check
# âœ… ê¸°ìˆ ì  ë³µìž¡ì„±: Threading, Context Manager
```

**Infrastructure ë°°ì¹˜ ê·¼ê±°**:

- **ì™¸ë¶€ ì‹œìŠ¤í…œ**: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë° ê´€ë¦¬
- **ë¦¬ì†ŒìŠ¤ ê´€ë¦¬**: Connection Pooling, Thread Safety
- **ê¸°ìˆ ì  íŒ¨í„´**: Circuit Breaker, Health Check

### **3. ðŸ“ file_system_service.py** - â­â­â­â­â­ **ì™„ë²½ ì í•©**

```python
# âœ… ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™: íŒŒì¼ ì‹œìŠ¤í…œ, OS ë ˆë²¨ ìž‘ì—…
# âœ… ì–´ëŒ‘í„° íŒ¨í„´: Domain ìš”êµ¬ì‚¬í•­ â†’ OS API ë³€í™˜
# âœ… ì›ìžì  ì—°ì‚°: íŒŒì¼ ì•ˆì „ì„± ë³´ìž¥
# âœ… ì—ëŸ¬ ì²˜ë¦¬: OS ì˜ˆì™¸ â†’ Domain ì˜ˆì™¸ ë³€í™˜
```

**Infrastructure ë°°ì¹˜ ê·¼ê±°**:

- **ì™¸ë¶€ ì˜ì¡´ì„±**: íŒŒì¼ ì‹œìŠ¤í…œ, OS API
- **ê¸°ìˆ ì  ë³µìž¡ì„±**: ì›ìžì  íŒŒì¼ ì—°ì‚°, ì²´í¬ì„¬ ê²€ì¦
- **ì–´ëŒ‘í„° ì—­í• **: Domainê³¼ OS ì‚¬ì´ì˜ ê²©ë¦¬

### **4. ðŸŒ websocket_market_data_service.py** - â­â­â­â­â­ **ì™„ë²½ ì í•©**

```python
# âœ… ì™¸ë¶€ API ì—°ë™: Upbit WebSocket API
# âœ… ë¹„ë™ê¸° ì²˜ë¦¬: asyncio ê¸°ë°˜ ì‹¤ì‹œê°„ í†µì‹ 
# âœ… ì´ë²¤íŠ¸ ë°œí–‰: Infrastructure â†’ Domain Event ì „íŒŒ
# âœ… ë„¤íŠ¸ì›Œí¬ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬: ì—°ê²° ìƒíƒœ, ìž¬ì—°ê²° ë¡œì§
```

**Infrastructure ë°°ì¹˜ ê·¼ê±°**:

- **ì™¸ë¶€ API**: Upbit WebSocket í”„ë¡œí† ì½œ
- **ë¹„ë™ê¸° I/O**: ë„¤íŠ¸ì›Œí¬ í†µì‹  ê¸°ìˆ ì  ë³µìž¡ì„±
- **ì´ë²¤íŠ¸ ë¸Œë¦¬ì§€**: ì™¸ë¶€ ë°ì´í„° â†’ Domain Event ë³€í™˜

### **5. ðŸ“Š websocket_status_service.py** - â­â­â­â­ **ì í•©**

```python
# âœ… ì¸í”„ë¼ ëª¨ë‹ˆí„°ë§: WebSocket ì—°ê²° ìƒíƒœ ì¶”ì 
# âœ… ë¦¬ì†ŒìŠ¤ íš¨ìœ¨ì„±: ìƒíƒœ ìºì‹±, ì´ë²¤íŠ¸ ê¸°ë°˜ ì—…ë°ì´íŠ¸
# âœ… ê¸°ìˆ ì  ê´€ì‹¬ì‚¬: ì—°ê²° ëª¨ë‹ˆí„°ë§, Health Check
```

**Infrastructure ë°°ì¹˜ ê·¼ê±°**:

- **ê¸°ìˆ  ëª¨ë‹ˆí„°ë§**: WebSocket ì¸í”„ë¼ ìƒíƒœ ê´€ë¦¬
- **ì„±ëŠ¥ ìµœì í™”**: ìƒíƒœ ìºì‹± ë° íš¨ìœ¨ì  í´ë§

---

## âš ï¸ **ë°°ì¹˜ ìž¬ê²€í† ê°€ í•„ìš”í•œ ì„œë¹„ìŠ¤ë“¤**

### **6. ðŸŽ¨ theme_service.py** - â­â­ **ë¶€ì ì ˆ (ì™¸ë¶€ ì—°ê²° ê´€ì ì—ì„œ)**

```python
# âŒ ë‚´ë¶€ UI ë¡œì§: í…Œë§ˆ ë³€ê²½, ìŠ¤íƒ€ì¼ ì ìš© (ì™¸ë¶€ ì—°ê²° ì•„ë‹˜)
# âŒ ì‚¬ìš©ìž ë¹„ì¦ˆë‹ˆìŠ¤: ì„ í˜¸ë„ ê´€ë¦¬ (ë„ë©”ì¸/ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ì‹¬ì‚¬)
# â“ Configuration ì˜ì¡´ì„±: ì„¤ì • íŒŒì¼ ì½ê¸°ë§Œ í•˜ëŠ” ì •ë„
# âŒ PyQt6 ê²°í•©: UI í”„ë ˆìž„ì›Œí¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€
```

**ì™¸ë¶€ ì—°ê²° ê´€ì ì—ì„œ ë¶€ì ì ˆí•œ ì´ìœ **:

- **ë‚´ë¶€ ë¡œì§**: í…Œë§ˆ ì„ íƒê³¼ ì ìš©ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ ì›Œí¬í”Œë¡œìš°
- **ì‚¬ìš©ìž ë¹„ì¦ˆë‹ˆìŠ¤**: UI ì„ í˜¸ë„ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ (ì™¸ë¶€ ì‹œìŠ¤í…œ ì•„ë‹˜)
- **PyQt6ëŠ” ë‚´ë¶€**: UI í”„ë ˆìž„ì›Œí¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¼ë¶€

**ê°œì„  ì œì•ˆ**:

```python
# í˜„ìž¬: Infrastructure Layer
upbit_auto_trading/infrastructure/services/theme_service.py

# ì œì•ˆ: Application Layerë¡œ ì´ë™
upbit_auto_trading/application/services/ui_theme_service.py
```

### **7. âš™ï¸ settings_service.py** - â­ **ì™„ì „ ë¶€ì ì ˆ (ì™¸ë¶€ ì—°ê²° ê´€ì ì—ì„œ)**

```python
# âŒ ë‚´ë¶€ ë¹„ì¦ˆë‹ˆìŠ¤: UI ì„¤ì •, ë§¤ë§¤ ì„¤ì • ê´€ë¦¬ (ì™¸ë¶€ ì‹œìŠ¤í…œ ì•„ë‹˜)
# âŒ ì‚¬ìš©ìž ì›Œí¬í”Œë¡œìš°: ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ ë¡œì§ (ì™¸ë¶€ ì—°ê²° ë¬´ê´€)
# â“ Configuration íŒŒì¼: ë‹¨ìˆœ íŒŒì¼ ì½ê¸°ëŠ” ì™¸ë¶€ì§€ë§Œ ì£¼ëœ ê´€ì‹¬ì‚¬ ì•„ë‹˜
# âŒ ë„ë©”ì¸ ê°œë…: UIConfig, TradingConfigëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸
```

**ì™¸ë¶€ ì—°ê²° ê´€ì ì—ì„œ ì™„ì „ ë¶€ì ì ˆ**:

- **ì‚¬ìš©ìž ì„¤ì • ê´€ë¦¬**: ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- **UI/Trading Config**: ë„ë©”ì¸ ê°œë…ì´ë©° ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë¬´ê´€
- **ì„¤ì • ì›Œí¬í”Œë¡œìš°**: ì‚¬ìš©ìž Use Case (ì™¸ë¶€ ì—°ê²°ì´ ì•„ë‹˜)

**ì´ë™ ì œì•ˆ**:

```python
# í˜„ìž¬: Infrastructure Layer (ë¶€ì ì ˆ)
upbit_auto_trading/infrastructure/services/settings_service.py

# ì œì•ˆ: Application Layerë¡œ ì´ë™
upbit_auto_trading/application/services/settings_application_service.py
```

### **8. ðŸ“ˆ orderbook_data_service.py** - â­â­â­ **ê²½ê³„ì„  (í•˜ì´ë¸Œë¦¬ë“œ)**

```python
# âœ… Infrastructure ì¸¡ë©´: WebSocket, REST API ì—°ë™
# â“ Application ì¸¡ë©´: í˜¸ê°€ì°½ ë°ì´í„°ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸
# â“ UI ê²°í•©: PyQt6 QObject, pyqtSignal ì‚¬ìš©
# âœ… ì´ë²¤íŠ¸ í†µí•©: ì—¬ëŸ¬ ë°ì´í„° ì†ŒìŠ¤ í†µí•©
```

**ë³µìž¡ì„± ë¶„ì„**:

- **ê¸°ìˆ ì  í†µí•©**: WebSocket + REST API ì¡°í•©ì€ Infrastructure ê´€ì‹¬ì‚¬
- **ë°ì´í„° ì˜ë¯¸**: í˜¸ê°€ì°½ì€ Domain/Application ê°œë…
- **UI ê²°í•©**: PyQt6 ì˜ì¡´ì„±ìœ¼ë¡œ Presentation ì„±ê²©ë„ ìžˆìŒ

**í˜„ìž¬ ìœ„ì¹˜ ìœ ì§€ ê·¼ê±°**:

- ì™¸ë¶€ API í†µí•©ì˜ ê¸°ìˆ ì  ë³µìž¡ì„±ì´ ì£¼ëœ ê´€ì‹¬ì‚¬
- Infrastructureì—ì„œ ë°ì´í„° ìˆ˜ì§‘ í›„ Applicationìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” íŒ¨í„´

---

## ðŸŽ¯ **ê°œì„  ê¶Œìž¥ì‚¬í•­**

### **ì¦‰ì‹œ ì´ë™ ê¶Œìž¥ (Priority 1)**

#### **settings_service.py â†’ Application Layer**

```bash
# ì´ë™ ê²½ë¡œ
upbit_auto_trading/infrastructure/services/settings_service.py
â†’ upbit_auto_trading/application/services/settings_application_service.py
```

**ì´ë™ ê·¼ê±°**:

- ì‚¬ìš©ìž ì„¤ì • ê´€ë¦¬ëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- UIConfig, TradingConfigëŠ” Domain ëª¨ë¸
- Infrastructure Configurationì„ ì˜ì¡´ì„±ìœ¼ë¡œ ì£¼ìž…ë°›ì•„ ì‚¬ìš©

### **ê²€í†  í›„ ê²°ì • (Priority 2)**

#### **theme_service.py ìœ„ì¹˜ ìž¬í‰ê°€**

```bash
# ì˜µì…˜ 1: Application Layerë¡œ ì´ë™
upbit_auto_trading/application/services/ui_theme_service.py

# ì˜µì…˜ 2: í˜„ìž¬ ìœ„ì¹˜ ìœ ì§€ (Configuration ì¤‘ì‹¬ ê´€ì )
upbit_auto_trading/infrastructure/services/theme_service.py
```

**ê²°ì • ê¸°ì¤€**: í…Œë§ˆ ì„œë¹„ìŠ¤ì˜ ì£¼ëœ ì—­í• ì´ Configuration ê´€ë¦¬ëƒ, UI ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ëƒ

---

## ðŸ“Š **ìµœì¢… í‰ê°€ ìš”ì•½**

| ì„œë¹„ìŠ¤ | í˜„ìž¬ ìœ„ì¹˜ | ì ì ˆì„± | ê¶Œìž¥ ì¡°ì¹˜ | ìš°ì„ ìˆœìœ„ |
|--------|-----------|--------|-----------|----------|
| api_key_service | Infrastructure | â­â­â­â­â­ | ìœ ì§€ | - |
| database_connection_service | Infrastructure | â­â­â­â­â­ | ìœ ì§€ | - |
| file_system_service | Infrastructure | â­â­â­â­â­ | ìœ ì§€ | - |
| websocket_market_data_service | Infrastructure | â­â­â­â­â­ | ìœ ì§€ | - |
| websocket_status_service | Infrastructure | â­â­â­â­ | ìœ ì§€ | - |
| orderbook_data_service | Infrastructure | â­â­â­ | í˜„ìž¬ ìœ ì§€ | ê²€í†  |
| theme_service | Infrastructure | â­â­â­ | ìž¬ê²€í†  | ì¤‘ê°„ |
| settings_service | Infrastructure | â­â­ | Applicationìœ¼ë¡œ ì´ë™ | **ë†’ìŒ** |

---

## ðŸ’¡ **ë ˆì´ì–´ ë°°ì¹˜ ì›ì¹™ ì •ë¦¬**

### âœ… **Infrastructure Layerì— ì í•©í•œ ì„œë¹„ìŠ¤**

- ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ (DB, API, File System)
- ê¸°ìˆ ì  ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ (Connection Pool, Memory)
- ë„¤íŠ¸ì›Œí¬/ë³´ì•ˆ/ì•”í˜¸í™” ì²˜ë¦¬
- OS/í•˜ë“œì›¨ì–´ ë ˆë²¨ ìž‘ì—…
- Cross-cutting ê¸°ìˆ  ì„œë¹„ìŠ¤

### âŒ **Infrastructure Layerì— ë¶€ì í•©í•œ ì„œë¹„ìŠ¤**

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
- ì‚¬ìš©ìž ì›Œí¬í”Œë¡œìš° ê´€ë¦¬
- Domain ëª¨ë¸ ì¡°ìž‘
- Application Use Case êµ¬í˜„
- UI ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™

### ðŸ¤” **ê²½ê³„ì„  ì¼€ì´ìŠ¤ íŒë‹¨ ê¸°ì¤€**

1. **ì£¼ëœ ê´€ì‹¬ì‚¬**: ê¸°ìˆ ì  vs ë¹„ì¦ˆë‹ˆìŠ¤ì 
2. **ì™¸ë¶€ ì˜ì¡´ì„±**: ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ì—¬ë¶€
3. **ìž¬ì‚¬ìš©ì„±**: Cross-cutting vs íŠ¹ì • ë„ë©”ì¸
4. **ë³€ê²½ ì´ìœ **: ê¸°ìˆ  ë³€ê²½ vs ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­ ë³€ê²½

---

> **ðŸŽ¯ ê²°ë¡ **: 8ê°œ ì„œë¹„ìŠ¤ ì¤‘ 6ê°œëŠ” Infrastructure Layer ë°°ì¹˜ê°€ ì ì ˆí•˜ë©°,
> **settings_service.py**ëŠ” Application Layerë¡œ ì´ë™ ê¶Œìž¥,
> **theme_service.py**ëŠ” ì¶”ê°€ ê²€í†  í•„ìš”
