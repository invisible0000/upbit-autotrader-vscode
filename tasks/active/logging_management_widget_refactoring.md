# 🔧 로깅 관리 UI 위젯 리팩토링
**Priority**: HIGH
**Status**: ACTIVE
**Created**: 2025-08-12 14:10
**Assignee**: GitHub Copilot

## 📋 **태스크 개요**
기존 로깅 관리 시스템을 올바른 위젯 구조로 리팩토링하여 설정 파일 기반으로 전환

## 🎯 **목표**
- [x] 문제 분석 완료
- [ ] 위젯 구조 리팩토링 (3개 위젯)
- [ ] 설정 파일 통합
- [ ] 레거시 파일 정리
- [ ] 테스트 및 검증

## 📐 **UI 구조**
```
┌─────────────┬───────────────────────────┐
│             │      로그 뷰어              │
│  로깅 설정   │    (우측 상단)             │
│  (좌측)     │                           │
│             ├───────────────────────────┤
│             │     콘솔 뷰어              │
│             │    (우측 하단)             │
└─────────────┴───────────────────────────┘
   비율 1:2       우측 내부 비율 2:1
```

## 📂 **작업 항목**

### Phase 1: 위젯 분리 (✅ 완료)
- [x] **1.1** `logging_settings_widget.py` 생성 - **완료**
  - [x] 로그 레벨 설정
  - [x] 콘솔 출력 토글
  - [x] 로그 스코프 설정
  - [x] 파일 로깅 설정
  - [x] 컴포넌트 집중 설정

- [x] **1.2** `log_viewer_widget.py` 생성 - **완료**
  - [x] 로그 메시지 표시 영역
  - [x] 자동 스크롤 기능
  - [x] 로그 필터링
  - [x] 로그 저장 기능

- [x] **1.3** `console_viewer_widget.py` 생성 - **완료**
  - [x] 콘솔 출력 표시 영역
  - [x] 실시간 콘솔 캡처
  - [x] 콘솔 내용 지우기

### Phase 2: 메인 뷰 통합 (✅ 완료)
- [x] **2.1** `logging_management_view.py` 수정 - **완료**
  - [x] 기존 파일 백업 (logging_management_view_backup.py)
  - [x] 3개 위젯 레이아웃 구성
  - [x] 스플리터 비율 설정 (1:2, 2:1)
  - [x] 위젯 간 시그널 연결

- [x] **2.2** MVP 패턴 Presenter 백업 및 재작성 - **완료**
  - [x] 기존 Presenter 백업 (logging_management_presenter_backup.py)
  - [x] Config 파일 기반 로직 구현
  - [x] 실시간 설정 적용
  - [x] 이벤트 핸들링

### Phase 3: UI 테스트 및 검증 (✅ 완료)
- [x] **3.1** 통합 테스트 실행 - **✅ 완료**
  - [x] 메인 View 파일 재작성 (DDD/MVP 패턴 엄격 준수)
  - [x] 메인 Presenter 파일 재작성 (Config 파일 기반)
  - [x] 메인 UI 실행 (`python run_desktop_ui.py`) - **✅ 성공**
  - [x] 3-위젯 레이아웃 확인 - **✅ 정상 표시**
  - [x] 설정 변경 동작 확인 - **✅ Config 파일 기반 동작**
  - [x] UI 프리징 방지 확인 - **✅ 환경변수 의존성 제거 완료**

### Phase 4: UI 개선 및 최적화 (✅ 완료)
- [X] **4.1** Presenter 로직 단순화 - **✅ 완료**
  - [X] 불필요한 로그 저장 기능 제거 완료
  - [X] 실시간 로그 읽기만 유지 (Infrastructure 로깅 시스템 활용)
  - [X] LoggingConfigManager의 올바른 메서드 사용 (`get_current_config`, `update_logging_config`)
  - [X] 기존 파일 백업 (`logging_management_presenter_backup.py`)
  - [X] DDD/MVP 패턴 엄격 준수하며 단순화 완료
  - [X] 실시간 로그 모니터링 타이머 구현 (1초 간격)

- [X] **4.2** 로그 뷰어 UI 개선 - **✅ 완료**
  - [X] 로그 하이라이트 기능 추가 (`log_syntax_highlighter.py` 구현)
  - [X] 폰트 크기 조절 기능 추가 (6-20px 범위)
  - [X] 로그 레벨별 색상 구분 (DEBUG, INFO, WARNING, ERROR, CRITICAL)
  - [X] 타임스탬프, 컴포넌트명, 특수 메시지 이모지 강조
  - [X] 테마 시스템 연동 (다크/라이트 테마 자동 전환)

- [X] **4.3** 환경 프로파일 지연 로딩 최적화 - **✅ 완료**
  - [X] EnvironmentProfilePresenter 지연 초기화 구현
  - [X] EnvironmentProfileView showEvent 기반 지연 로딩 구현
  - [X] 프로파일 탭 미사용시 config YAML 탐색 방지
  - [X] 로그 노이즈 대폭 감소 (ProfileMetadataService DEBUG 로그 최소화)

### Phase 5: 실시간 로그 연결 및 최종 테스트 (🔄 진행중)
- [x] **5.1** 실시간 로그 스트리밍 연결 - **✅ 완료**
  - [x] LoggingManagementPresenter와 LogViewerWidget 시그널 연결
  - [x] Infrastructure 로깅 시스템 실시간 로그 파일 모니터링
  - [x] 새 로그 라인 추가시 구문 강조 자동 적용
  - [x] 자동 스크롤 기능 완성

- [x] **5.2** 로그 뷰어 기본 설정 조정 - **✅ 완료**
  - [x] 폰트 크기 기본값 12px로 변경
  - [x] 초기 로드시 현재 세션 로그 표시
  - [x] 로그 내용 복사 기능 확인 (QTextEdit 표준 기능 Ctrl+C)

- [ ] **5.3** 콘솔 뷰어 실시간 연결
  - [ ] 콘솔 출력 실시간 캡처 구현
  - [ ] 콘솔 내용 필터링 기능
  - [ ] 콘솔 지우기 기능 연결

- [ ] **5.4** 설정 적용 및 저장 테스트
  - [ ] 로깅 설정 변경시 즉시 반영 확인
  - [ ] Config 파일 기반 설정 저장/복원 검증
  - [ ] 프로그램 재시작 후 설정 유지 확인

- [ ] **5.5** 통합 테스트 및 검증
  - [ ] 3-위젯 레이아웃 안정성 확인
  - [ ] 테마 변경시 정상 동작 확인
  - [ ] 전체 기능 통합 테스트
  - [ ] 성능 및 메모리 사용량 확인

- [ ] **4.3** 콘솔 뷰어 UI 개선
  - [ ] 실시간 콘솔 모니터링
  - [ ] 출력 포맷팅 개선

### Phase 6: 레거시 정리
- [ ] **3.1** 불필요 파일 제거
  - [ ] 환경변수 기반 코드 제거
  - [ ] LLM 관련 설정 제거
  - [ ] 사용하지 않는 위젯 정리

- [ ] **3.2** 코드 정리
  - [ ] Import 정리
  - [ ] 사용하지 않는 메서드 제거
  - [ ] 문서 업데이트

### Phase 4: 테스트 및 검증
- [ ] **4.1** 기능 테스트
  - [ ] 설정 변경 동작 확인
  - [ ] 파일 저장/로드 확인
  - [ ] UI 반응성 확인

- [ ] **4.2** 통합 테스트
  - [ ] 프로그램 재시작 후 설정 유지 확인
  - [ ] 프로파일 시스템과 연동 확인

## ⚠️ **위험 요소**
- 기존 로깅 시스템과의 호환성
- UI 프리징 방지
- 설정 파일 충돌 방지

## 📝 **작업 노트**
- 환경변수 → 설정 파일 기반으로 전환 중
- UI 프리징 문제 해결 필요
- 로그 파일 경로 하드코딩 문제 해결

## ✅ **완료 기준**
- [ ] 3개 위젯이 올바른 레이아웃으로 배치
- [ ] 설정 변경이 즉시 반영
- [ ] 프로그램 재시작 후 설정 유지
- [ ] UI 프리징 없음
- [ ] 레거시 코드 완전 제거
