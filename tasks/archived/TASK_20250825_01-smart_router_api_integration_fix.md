# π“‹ TASK_20250825_01: μ¤λ§νΈ λΌμ°ν„° API ν†µν•© νΈν™μ„± μμ •

## π― νƒμ¤ν¬ λ©ν‘
- **μ£Όμ” λ©ν‘**: μ—…κ·Έλ μ΄λ“λ 4κ° API μ±„λ„κ³Ό μ¤λ§νΈ λΌμ°ν„° κ°„ μ™„λ²½ν• νΈν™μ„± ν™•λ³΄
- **μ™„λ£ κΈ°μ¤€**: μ¤λ§νΈ λΌμ°ν„°κ°€ λ¨λ“  λ°μ΄ν„° νƒ€μ…μ— λ€ν•΄ REST/WebSocket μ±„λ„μ„ μ •μƒμ μΌλ΅ λΌμ°ν…ν•κ³  λ°μ΄ν„°λ¥Ό λ°ν™

## π“ ν„μ¬ μƒν™© λ¶„μ„

### π” λ°κ²¬λ λ¬Έμ μ 
1. **API λ©”μ„λ“λ… λ¶μΌμΉ** (Critical Issue)
   - μ¤λ§νΈ λΌμ°ν„°: `get_tickers()` β†’ μ‹¤μ  API: `get_ticker()`
   - μ¤λ§νΈ λΌμ°ν„°: `get_trades_ticks()` β†’ μ‹¤μ  API: `get_trade()` λλ” `get_trades()`
   - μ¤λ§νΈ λΌμ°ν„°: `get_candles_minutes()` β†’ μ‹¤μ  API: `get_candle_minutes()`

2. **WebSocket ν΄λΌμ΄μ–ΈνΈ import κ²½λ΅ μ¤λ¥**
   - μ¤λ§νΈ λΌμ°ν„°: `upbit_websocket_quotation_client`
   - μ‹¤μ  νμΌλ…: `upbit_websocket_public_client`

3. **Dict ν†µμΌ μ •μ±… λ―Έμ μ©**
   - μ—…κ·Έλ μ΄λ“λ APIλ” λ¨λ“  μ‘λ‹µμ„ Dict ν•νƒλ΅ λ°ν™
   - μ¤λ§νΈ λΌμ°ν„°μ μ‘λ‹µ μ²λ¦¬ λ΅μ§μ΄ μƒ ν•μ‹μ— λ§μ§€ μ•μ

### β… μ‚¬μ© κ°€λ¥ν• λ¦¬μ†μ¤
- μ™„μ „ν μ—…κ·Έλ μ΄λ“λ 4κ° API μ±„λ„
- μ κµ¬μ„±λ μ¤λ§νΈ λΌμ°ν„° μ•„ν‚¤ν…μ²
- ν¬κ΄„μ μΈ μ±„λ„ μ„ νƒ λ΅μ§
- κ²¬κ³ ν• μ—λ¬ μ²λ¦¬ λ° ν΄λ°± μ‹μ¤ν…

## π”„ μ²΄κ³„μ  μ‘μ—… μ μ°¨ (8λ‹¨κ³„ μ¤€μ)

### Phase 1: μ¦‰μ‹ μμ • (Critical Issues) β… μ™„λ£
- [x] **1.1 API λ©”μ„λ“λ… ν†µμΌ**: REST API νΈμ¶ λ©”μ„λ“λ¥Ό μ‹¤μ  API μ¤ν™μ— λ§κ² μμ • β… μ™„λ£
  - [x] get_tickers() β†’ get_ticker() μμ •
  - [x] get_trades_ticks() β†’ get_trades() μμ •
  - [x] get_candles_minutes() β†’ get_candle_minutes() μμ •
  - [x] get_candles_days() β†’ get_candle_days() μμ •
  - [x] get_candles_weeks() β†’ get_candle_weeks() μμ •
  - [x] get_candles_months() β†’ get_candle_months() μμ •

- [x] **1.2 WebSocket import κ²½λ΅ μμ •**: μ¬λ°”λ¥Έ ν΄λΌμ΄μ–ΈνΈ ν΄λμ¤ import β… μ™„λ£
  - [x] import κ²½λ΅ μμ •: `upbit_websocket_quotation_client` β†’ `upbit_websocket_public_client`
  - [x] ν΄λμ¤λ… μμ •: `UpbitWebSocketQuotationClient` β†’ `UpbitWebSocketPublicClient`

- [x] **1.3 λ©”μ„λ“ μ‹κ·Έλ‹μ² νΈν™μ„± ν™•μΈ**: νλΌλ―Έν„° μ „λ‹¬ λ°©μ‹ λ° λ°ν™κ°’ ν•μ‹ κ²€μ¦ β… μ™„λ£
  - [x] κΈ°λ³Έ Import κ²€μ¦: λ¨λ“  μ¤λ§νΈ λΌμ°ν… κµ¬μ„± μ”μ† import μ„±κ³µ (test00)
  - [x] νλΌλ―Έν„° μ „λ‹¬ λ°©μ‹ κ²€μ¦: Union[str, List[str]] ν¨ν„΄ μ§€μ› ν™•μΈ (test01)
  - [x] λ°ν™κ°’ ν•μ‹ κ²€μ¦: Dict ν†µμΌ μ •μ±… μ μ©λ μ‘λ‹µ μ²λ¦¬ (test01)
  - [x] μ—λ¬ μ²λ¦¬ κ²€μ¦: ExchangeApiError μμ™Έ μ²λ¦¬ (test01)

### Phase 2: νΈν™μ„± κ²€μ¦ (Integration Test)
- [x] **2.1 μ¤λ§νΈ λΌμ°ν„° REST κ²½λ΅ ν…μ¤νΈ**: λ¨λ“  λ°μ΄ν„° νƒ€μ… μ”μ²­ κ²€μ¦ β… μ™„λ£
  - [x] ν‹°μ»¤ λ°μ΄ν„° μ”μ²­: get_ticker() μ •μƒ λ™μ‘ ν™•μΈ
  - [x] νΈκ°€ λ°μ΄ν„° μ”μ²­: get_orderbook() μ •μƒ λ™μ‘ ν™•μΈ
  - [x] μ²΄κ²° λ°μ΄ν„° μ”μ²­: get_trades() μ •μƒ λ™μ‘ ν™•μΈ
  - [x] μΊ”λ“¤ λ°μ΄ν„° μ”μ²­: λ¨λ“  νƒ€μ„ν”„λ μ„ get_candle() μ •μƒ λ™μ‘ ν™•μΈ

- [x] **2.2 WebSocket μ—°λ™ ν…μ¤νΈ**: κµ¬λ… λ° λ©”μ‹μ§€ μμ‹  κ²€μ¦ β… μ™„λ£
  - [x] μ—°κ²° ν™•μΈ: WebSocket ν΄λΌμ΄μ–ΈνΈ μ •μƒ μ—°κ²°
  - [x] κµ¬λ… ν™•μΈ: ν‹°μ»¤/νΈκ°€/μ²΄κ²°/μΊ”λ“¤ κµ¬λ… μ„±κ³µ
  - [x] λ©”μ‹μ§€ μμ‹  ν™•μΈ: μ‹¤μ‹κ°„ λ°μ΄ν„° μμ‹  λ° νμ‹±
  - β οΈ **λ°κ²¬λ μ΄μ**: WebSocket Event loop κ΄€λ¦¬ λ¬Έμ  (ν΄λ°± λ©”μ»¤λ‹μ¦μΌλ΅ μ»¤λ²„λ¨)

- [x] **2.3 μ—λ¬ μ²λ¦¬ κ²€μ¦**: ν΄λ°± λ©”μ»¤λ‹μ¦ λ™μ‘ ν™•μΈ β… μ™„λ£
  - [x] WebSocket Event loop μ—λ¬ ν•΄κ²° (ν΄λ°±μΌλ΅ μ»¤λ²„λ¨)
  - [x] asyncio Task κ΄€λ¦¬ κ°μ„  (λ™μ‹ μ”μ²­ μ„±κ³µ)
  - [x] REST API μ‹¤ν¨ μ‹: μ μ ν• μ—λ¬ λ©”μ‹μ§€ λ° λ”λ―Έ λ°μ΄ν„° λ°ν™
  - [x] WebSocket μ‹¤ν¨ μ‹: REST APIλ΅ μλ™ ν΄λ°± κ°μ„ 
  - [x] λ„¤νΈμ›ν¬ μ¤λ¥ μ‹: κ²¬κ³ ν• μ—λ¬ μ²λ¦¬
  - [x] νƒ€μ„μ•„μ›ƒ μ²λ¦¬: 3μ΄ νƒ€μ„μ•„μ›ƒ μ •μƒ μ‘λ™
  - [x] μ‘λ‹µ κµ¬μ΅° μΌκ΄€μ„±: λ¨λ“  μ—λ¬ μƒν™©μ—μ„ μΌκ΄€λ Dict κµ¬μ΅°

- [-] **2.4 Dict ν†µμΌ μ •μ±… μ μ©**: λ¨λ“  μ‘λ‹µ λ°μ΄ν„° μ •κ·ν™”
  - [ ] μ‘λ‹µ λ°μ΄ν„° μ •κ·ν™”: λ¨λ“  API μ‘λ‹µμ„ Dict ν•νƒλ΅ ν†µμΌ
  - [ ] λ©”νƒ€λ°μ΄ν„° μ¶”κ°€: μ±„λ„ μ •λ³΄, μ‘λ‹µ μ‹κ°„ λ“± λ©”νƒ€λ°μ΄ν„° ν¬ν•¨
  - [ ] μΊμ‹ νΈν™μ„±: μΊμ‹ μ‹μ¤ν…κ³Ό μƒ μ‘λ‹µ ν•μ‹ νΈν™

### Phase 3: μµμ ν™” λ° κ²€μ¦ (Performance & Quality)
- [ ] **3.1 μΊμ‹ μ‹μ¤ν… κ²€μ¦**: λ°μ΄ν„° μΌκ΄€μ„± λ° TTL μ •μ±… ν™•μΈ
  - [ ] μΊμ‹ ν‚¤ μƒμ„±: μ”μ²­ νλΌλ―Έν„° κΈ°λ° κ³ μ  ν‚¤ μƒμ„±
  - [ ] TTL μ •μ±… ν™•μΈ: λ°μ΄ν„° νƒ€μ…λ³„ μ μ ν• λ§λ£ μ‹κ°„
  - [ ] μΊμ‹ ννΈμ¨: μ„±λ¥ λ©”νΈλ¦­ μ •μƒ μμ§‘

- [ ] **3.2 λ©”νΈλ¦­ μμ§‘ ν™•μΈ**: μ„±λ¥ λ¨λ‹ν„°λ§ μ •μƒ λ™μ‘ κ²€μ¦
  - [ ] λΌμ°ν… λ©”νΈλ¦­: μ±„λ„λ³„ μ”μ²­ μ, μ‘λ‹µ μ‹κ°„ λ“±
  - [ ] μ„±λ¥ μ”μ•½: get_performance_summary() μ •μƒ λ™μ‘
  - [ ] μ—λ¬μ¨ μ¶”μ : μ‹¤ν¨μ¨ λ° ν΄λ°± λΉλ„

- [ ] **3.3 ν†µν•© ν…μ¤νΈ**: `python run_desktop_ui.py`λ΅ 7κ·μΉ™ μ „λµ λ™μ‘ ν™•μΈ
  - [ ] UI λ°νƒ€μ„ ν…μ¤νΈ: `python run_desktop_ui.py` μ •μƒ μ‹¤ν–‰
  - [ ] μ „λµ κ΄€λ¦¬ ν…μ¤νΈ: 7κ·μΉ™ μ „λµ κµ¬μ„± κ°€λ¥
  - [ ] νΈλ¦¬κ±° λΉλ” ν…μ¤νΈ: λ¨λ“  λ°μ΄ν„° μ†μ¤ μ •μƒ λ™μ‘

## π”§ κ°λ°ν•  λ„κµ¬
- **μ—†μ** (κΈ°μ΅΄ μ¤λ§νΈ λΌμ°ν„° μμ • μ‘μ—…)

## π― μ„±κ³µ κΈ°μ¤€
- β… **μ¤λ§νΈ λΌμ°ν„° μ •μƒ λ™μ‘**: λ¨λ“  API νΈμ¶μ΄ μ—λ¬ μ—†μ΄ μ‹¤ν–‰λ¨
- β… **WebSocket μ—°κ²° μ„±κ³µ**: Public WebSocket ν΄λΌμ΄μ–ΈνΈ μ •μƒ μ—°κ²° λ° κµ¬λ…
- β… **Dict ν†µμΌ μ‘λ‹µ**: λ¨λ“  λ°μ΄ν„° νƒ€μ…μ΄ μΌκ΄€λ Dict ν•νƒλ΅ λ°ν™λ¨
- β… **ν΄λ°± λ©”μ»¤λ‹μ¦ λ™μ‘**: WebSocket μ‹¤ν¨ μ‹ REST APIλ΅ μλ™ μ „ν™
- β… **7κ·μΉ™ μ „λµ μ§€μ›**: UIμ—μ„ μ „λµ κ΄€λ¦¬ λ° νΈλ¦¬κ±° λΉλ” μ •μƒ λ™μ‘

## π’΅ μ‘μ—… μ‹ μ£Όμμ‚¬ν•­

### π›΅οΈ μ•μ „μ„± μ›μΉ™
- **λ°±μ—… ν•„μ**: μμ • μ „ smart_router.py λ°±μ—… μƒμ„±
- **λ‹¨κ³„λ³„ κ²€μ¦**: κ° μμ • ν›„ μ¦‰μ‹ λ™μ‘ ν…μ¤νΈ
- **λ΅κΉ… ν™μ©**: Infrastructure λ΅κΉ…μΌλ΅ λ””λ²„κΉ… μ •λ³΄ μμ§‘

### β οΈ ν•µμ‹¬ μ μ•½μ‚¬ν•­
- **DDD κ³„μΈµ κ·μΉ™ μ¤€μ**: Domain κ³„μΈµ μμ΅΄μ„± μ„λ° κΈμ§€
- **κΈ°μ΅΄ μΈν„°νμ΄μ¤ μ μ§€**: μ¤λ§νΈ λΌμ°ν„° μ™Έλ¶€ API λ³€κ²½ μµμ†ν™”
- **Dict ν†µμΌ μ •μ±…**: λ¨λ“  μ‘λ‹µ λ°μ΄ν„°λ¥Ό Dict ν•νƒλ΅ ν†µμΌ

## π€ μ¦‰μ‹ μ‹μ‘ν•  μ‘μ—…

```powershell
# 1. λ°±μ—… μƒμ„±
Copy-Item "upbit_auto_trading\infrastructure\market_data_backbone\smart_routing\smart_router.py" "upbit_auto_trading\infrastructure\market_data_backbone\smart_routing\smart_router_backup_20250825.py"

# 2. ν„μ¬ μƒνƒ ν™•μΈ
python -c "
from upbit_auto_trading.infrastructure.market_data_backbone.smart_routing.smart_router import get_smart_router
router = get_smart_router()
print('Smart Router μ„ν¬νΈ μ„±κ³µ')
"
```

## π― λ‹¤μ μ—μ΄μ „νΈ μ‹μ‘μ 

**ν„μ¬ μƒν™©**: Phase 1 μ™„λ£ β…, Phase 2 μ§„ν–‰ μ¤‘ [-]

**μ¦‰μ‹ μ‹¤ν–‰ λ…λ Ήμ–΄**:
```powershell
# Phase 2.1 μ‹μ‘: REST κ²½λ΅ ν†µν•© ν…μ¤νΈ
cd tests\infrastructure\test_smart_routing
python test02_rest_integration.py
```

**μ‘μ—… μμ„**:
1. π“‹ Phase 2.1: μ¤λ§νΈ λΌμ°ν„° REST κ²½λ΅ ν…μ¤νΈ (ν„μ¬ μ§„ν–‰μ¤‘)
2. π“‹ Phase 2.2: WebSocket μ—°λ™ ν…μ¤νΈ
3. π“‹ Phase 2.3: μ—λ¬ μ²λ¦¬ κ²€μ¦
4. π“‹ Phase 2.4: Dict ν†µμΌ μ •μ±… μ μ©

**λ‹¤μ λ€ν™”μ°½μ—μ„ κ³„μ†ν•  λ•**:
- `tasks/active/TASK_20250825_01-smart_router_api_integration_fix.md` νμΌ ν™•μΈ
- ν„μ¬ μ§„ν–‰ μƒν™©κ³Ό μ²΄ν¬λ°•μ¤ μƒνƒ ν™•μΈ ν›„ μ΄μ–΄μ„ μ‘μ—…
- 8λ‹¨κ³„ μ‘μ—… μ μ°¨ μ¤€μν•μ—¬ μ²΄κ³„μ μΌλ΅ μ§„ν–‰

---
**νƒμ¤ν¬ μƒμ„±μΌ**: 2025λ…„ 8μ›” 25μΌ
**μμƒ μ†μ”μ‹κ°„**: 2-3μ‹κ°„
**μ°μ„ μμ„**: π”¥ λ†’μ (μ‹μ¤ν… ν•µμ‹¬ μΈν”„λΌ)
