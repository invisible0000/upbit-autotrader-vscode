# Upbit Autotrader GUI 개발 계획 (2025-07-19)

## 1. 개발 원칙
- 메인 대시보드(MainWindow) 기반, 모든 화면/위젯 일관된 스타일/UX 적용
- PyQt6 기반, 모듈별 분리/재사용성 강화
- 사용자 중심, 직관적 네비게이션/상태 표시
- 테마(다크/화이트) 일관성 및 가독성 보장
- **⚡ 성능 최적화**: API 제한사항 고려한 효율적 데이터 로딩

## 📊 **차트 최적화 전략** (2025-07-19 업데이트)

### 🎯 **업비트 API 제한사항 분석**
- **캔들 개수**: 한 번에 최대 **200개** 조회 가능
- **요청 제한**: 초당 10회, 분당 600회 (매우 넉넉함)
- **핵심 과제**: 창 크기와 기간에 맞는 **빠른 차트 렌더링**

### ⚡ **3단계 최적화 전략**

#### 1단계: 점진적 초기 로딩 (Lazy Loading)
```python
# 목표: 600개 캔들로 충분한 차트 표시
def fetch_initial_candles(market, interval, total_count=600):
    request_count = (total_count + 199) // 200  # 3회 요청
    for i in range(request_count):
        candles = upbit_api.get_candles(market, interval, count=200, to=last_time)
        all_candles = candles + all_candles  # 과거→현재 순서 유지
        last_time = candles[0]['candle_date_time_utc']
    # 1-2초 내 완전한 차트 표시 완료!
```

#### 2단계: 실시간 업데이트 (WebSocket)
```python
# 핵심: API 요청 0회로 실시간 차트 업데이트
def setup_websocket_realtime():
    # 체결(trade) 데이터 수신
    # 현재 캔들의 OHLCV 메모리에서 직접 계산
    # 1분 지나면 완성된 캔들을 차트에 추가
    # → 살아있는 차트, API 부하 없음!
```

#### 3단계: 과거 데이터 확장 (On-Scroll)
```python
# 사용자가 왼쪽 스크롤 시에만 과거 데이터 추가
def on_scroll_to_past():
    past_data = fetch_candles(market, interval, count=200, to=oldest_time)
    prepend_to_chart(past_data)  # 차트 앞부분에 추가
```

### 📈 **예상 성능 개선**
- **초기 로딩**: 600개 캔들, 3회 API 호출, **1-2초 완료**
- **실시간 업데이트**: 웹소켓, **API 요청 0회**
- **과거 확장**: 필요 시에만, 200개씩, **0.1초 응답**
- **메모리 효율**: 필요한 만큼만 로딩, 무제한 스크롤 가능

## 2. 주요 화면/기능
1. **대시보드**
   - 포트폴리오 요약, 시장 개요, 활성 거래 목록
   - 실시간 상태/알림 표시
2. **⚡ 종목 스크리닝** (차트 최적화 적용)
   - 거래량/변동성/추세 기반 스크리닝
   - **빠른 차트 미리보기**: 점진적 로딩으로 즉시 표시
   - 결과 필터/정렬/저장
3. **매매전략 관리**
   - 전략 목록/생성/수정/삭제
   - 전략 파라미터 설정
4. **⚡ 백테스팅** (차트 최적화 적용)
   - 전략별 시뮬레이션, **빠른 결과 시각화**
   - **대용량 데이터 처리**: 점진적 로딩으로 메모리 효율성
   - 성과/거래내역/비교
5. **⚡ 실시간 거래** (차트 최적화 적용)
   - 주문 생성/전송/상태 추적
   - **실시간 포지션/PNL**: 웹소켓 기반 즉시 업데이트
   - **실시간 차트**: API 부하 없는 살아있는 차트
6. **포트폴리오 구성**
   - 코인 추가/제거, 비중 조정
   - 성과/위험 지표 표시
7. **설정/로그인**
   - API키 관리, DB/알림 설정
   - 로그인/세션/보안
8. **알림센터**
   - 거래/시스템/오류 알림 목록 및 필터
9. **⚡ 테마/UX** (성능 고려)
   - 다크/화이트 모드, 가독성 개선
   - **반응형 차트**: 창 크기 변경 시 즉시 조정
   - 접근성 강화

## 3. 개발 단계 (차트 최적화 우선)
- **1단계**: ⚡ **차트 최적화 구현** (최우선, 1-2일)
  - `OptimizedChartDataLoader` 구현
  - `RealtimeChartUpdater` 웹소켓 연동
  - `AdvancedChartDataManager` 통합
- **2단계**: 대시보드/설정/로그인 화면 완성 및 테스트
- **3단계**: 종목 스크리닝/매매전략/백테스팅 화면 구현 (최적화된 차트 적용)
- **4단계**: 실시간 거래/포트폴리오/알림센터 통합
- **5단계**: 테마/UX/반응형/접근성 개선
- **6단계**: 통합 테스트, 사용자 피드백 반영, 문서화

## 4. 코드 구조/일관성 (성능 고려)
- MainWindow에서 모든 화면 전환/상태 관리
- screens/ 하위 모듈별 위젯/로직 분리
- **⚡ 차트 모듈**: `OptimizedChartDataLoader`, `RealtimeChartUpdater` 공통 사용
- signals/slots로 이벤트 처리, 테스트 용이성 강화
- 스타일/테마 공통 적용(QSS)
- **메모리 관리**: 대용량 차트 데이터 효율적 처리

## 5. 성능 요구사항 (추가)
- **차트 초기 로딩**: 2초 이내 완료
- **실시간 업데이트**: 지연시간 100ms 이하
- **스크롤 응답**: 0.1초 이내 과거 데이터 추가
- **메모리 사용량**: 차트당 최대 100MB
- **API 효율성**: 초당 요청 수 5회 이하 유지

## 6. 테스트/문서화 (성능 포함)
- 각 화면별 단위/통합 테스트 케이스 작성
- **차트 성능 테스트**: 로딩 시간, 메모리 사용량, API 요청 수 측정
- 설치/실행/사용자 매뉴얼, FAQ, 트러블슈팅 문서화
- **성능 최적화 가이드**: API 제한사항, 효율적 사용법 문서화

---

## 📋 **구현 우선순위 체크리스트**

### ✅ **즉시 구현 가능** (1-2일)
- [x] 업비트 API 클라이언트 (95% 완성)
- [ ] **차트 최적화 구현** ← **최우선**
  - [ ] `OptimizedChartDataLoader` 클래스
  - [ ] `RealtimeChartUpdater` 웹소켓
  - [ ] `AdvancedChartDataManager` 통합
- [ ] 기존 `chart_view_screen.py` 연동

### 🟡 **진행 중** (1주일)
- [ ] 실시간 거래 엔진 완성 (80% 완료)
- [ ] 대시보드 위젯 실데이터 연동
- [ ] 테마 전환 완전 안정화

### ⏳ **계획됨** (2-4주)
- [ ] 종목 스크리닝 (최적화된 차트 적용)
- [ ] 백테스팅 (대용량 데이터 처리)
- [ ] 포트폴리오 관리 고도화

---
추가 요청 시 세부 UI 설계, 화면별 와이어프레임, 코드 샘플, 개발 일정 등 상세 계획 제공 가능합니다.
