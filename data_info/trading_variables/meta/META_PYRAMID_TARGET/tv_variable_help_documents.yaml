META_PYRAMID_TARGET:
  concept:
    title: META_PYRAMID_TARGET (피라미딩 목표가) 개념과 정의
    content: '## 피라미딩 목표가의 기본 개념


      META_PYRAMID_TARGET은 동적 포지션 관리를 위한 핵심 변수로,

      기준점에서 설정된 차이만큼 가격이 변동할 때마다 추가 매수 신호를 발생시킵니다.

      불타기(상향 추적)와 물타기(하향 추적) 전략을 체계적으로 구현합니다.


      ### 기술적 정의


      ```

      피라미딩 목표가 = 기준점 ± (간격 × 실행횟수)


      불타기: 목표가 = 진입가 × (1 + 간격% × 횟수)

      물타기: 목표가 = 평단가 × (1 - 간격% × 횟수)

      ```


      ### 변수 메타데이터


      - **Purpose Category**: price

      - **Chart Category**: overlay

      - **Comparison Group**: price_comparable

      - **단위**: KRW (원화 기준)

      - **동작 방식**: 조건부 신호 발생 후 자동 갱신


      ### 피라미딩 전략의 원리


      **불타기 (Pyramid Up)**: 수익이 발생하는 상승 추세에서 추가 매수를 통해

      포지션을 확대하여 트렌드 수익을 극대화하는 전략입니다.

      진입가 기준으로 일정 비율 상승시마다 추가 매수를 실행합니다.


      **물타기 (Pyramid Down)**: 손실이 발생하는 하락 구간에서 추가 매수를 통해

      평균단가를 낮춰 회복 구간에서 더 빠른 손익분기를 달성하는 전략입니다.


      ### 리스크 관리 메커니즘


      피라미딩은 무제한 확장을 방지하기 위해 최대 실행 횟수를 설정합니다.

      설정된 횟수 소진시 자동으로 비활성화되어 과도한 포지션 확대를 방지하며,

      한 번 소진된 횟수는 재활성화되지 않습니다.


      ### 기준점 동적 갱신


      각 피라미딩 실행 후 새로운 목표가가 자동으로 계산되며,

      다음 신호까지의 거리가 재설정됩니다. 이를 통해 시장 상황에

      적응적으로 대응하면서도 체계적인 포지션 관리가 가능합니다.

      '
  advanced:
    title: META_PYRAMID_TARGET 고급 수학적 모델링
    content: '## 고급 피라미딩 수학적 최적화


      ### Kelly Criterion 기반 피라미딩 사이즈


      각 피라미딩 단계별 최적 투자 규모 계산:

      ```

      Kelly 비율 = (승률 × 평균수익 - 패율 × 평균손실) / 평균수익


      단계별 포지션 크기:

      1차: 기본 포지션 × Kelly비율

      2차: 기본 포지션 × Kelly비율 × 0.8  # 리스크 감소

      3차: 기본 포지션 × Kelly비율 × 0.6

      4차: 기본 포지션 × Kelly비율 × 0.4

      ```


      ### 확률적 피라미딩 모델


      **성공 확률 기반 실행 여부 결정:**

      ```

      피라미딩 성공률 = f(트렌드강도, 변동성, 거래량)


      실행 확률 임계값:

      성공률 > 60%: 피라미딩 실행

      성공률 < 40%: 피라미딩 중단

      40-60%: 50% 규모로 실행

      ```


      ### 동적 목표가 최적화


      **시장 구조 변화 반영:**

      ```

      적응형 간격 = 기본간격 × 시장조건계수


      시장조건계수:

      - 트렌드 강도: 0.5 (약한 트렌드) ~ 2.0 (강한 트렌드)

      - 변동성 지수: 0.8 (낮은 변동성) ~ 1.5 (높은 변동성)

      - 유동성 지수: 0.9 (높은 유동성) ~ 1.3 (낮은 유동성)

      ```


      ### 기관투자자 수준의 피라미딩


      **포트폴리오 레벨 피라미딩:**

      ```

      전체 포트폴리오 위험도 = Σ(개별종목 피라미딩 위험도)


      개별종목 피라미딩 한도:

      = (전체 위험예산 - 현재 위험도) / 해당종목 변동성


      동적 배분:

      성과 우수 종목 → 피라미딩 한도 증가

      성과 부진 종목 → 피라미딩 한도 감소

      ```


      ### 옵션 헤지와 피라미딩 결합


      **헤지 비율 동적 조정:**

      ```

      피라미딩 단계별 헤지 전략:


      1-2단계: 헤지 없음 (순수 방향성 배팅)

      3단계: Put 옵션 20% 헤지 (하방 보호)

      4단계: Put 옵션 40% 헤지 (리스크 관리 강화)


      헤지 비용 < 피라미딩 기대수익 × 30% 조건하에 실행

      ```


      ### 머신러닝 기반 피라미딩 신호


      **LSTM 모델 기반 피라미딩 타이밍:**

      ```

      입력 변수:

      - 과거 20일 가격 데이터

      - 피라미딩 실행 이력

      - 시장 거시 지표


      출력:

      - 피라미딩 성공 확률

      - 최적 간격 추천

      - 권장 실행 횟수

      ```


      ### 백테스팅 고도화


      **Monte Carlo 시뮬레이션:**

      ```

      시나리오 생성:

      - 10,000개 가격 경로 시뮬레이션

      - 각 경로별 피라미딩 전략 성과 측정


      최적화 지표:

      - 95% VaR (Value at Risk)

      - 최대 드로우다운 지속 기간

      - 샤프 비율 (변동성 조정 수익률)

      ```


      ### 극한 상황 대응 프로토콜


      **블랙 스완 이벤트 대응:**

      ```

      극한 상황 감지:

      일일 변동률 > 20% OR 연속 3일 10% 이상 하락


      비상 조치:

      1. 모든 피라미딩 즉시 중단

      2. 기존 피라미딩 포지션 50% 강제 청산

      3. 시장 정상화까지 신규 피라미딩 금지

      ```


      ### 세금 최적화 피라미딩


      **세무 효율적 피라미딩:**

      ```

      연간 실현손익 관리:

      - 수익 피라미딩: 다음 연도로 이익 이연

      - 손실 피라미딩: 당해 연도 손실 실현으로 절세


      FIFO vs 평균가 활용:

      한국: 평균가법 적용으로 피라미딩 효과 극대화

      해외: FIFO 선택으로 세무 최적화

      ```


      ### 성과 측정 전문 지표


      **피라미딩 전용 KPI:**

      ```

      피라미딩 효율성 = (피라미딩 수익 - 단순 보유 수익) / 추가 투자금

      신호 정확도 = 수익 피라미딩 횟수 / 전체 피라미딩 횟수

      자본 효율성 = 총 수익 / 최대 투입 자본

      ```


      ### 주의사항


      - 피라미딩은 트렌드가 지속될 때만 유효한 전략

      - 횟수 제한 없는 무제한 피라미딩은 파산 위험 존재

      - 시장 구조 급변시 모든 피라미딩 포지션이 동시 손실 가능

      - 유동성 부족시 대량 청산으로 슬리피지 발생 위험

      '
  usage:
    title: 트리거 빌더에서 META_PYRAMID_TARGET 실전 활용법
    content: '## 트리거 빌더 조건 설정 방법


      ### 기본 불타기 전략 설정


      ```

      조건 1: CURRENT_PRICE >= META_PYRAMID_TARGET  # 목표가 도달

      조건 2: PROFIT_PERCENT > 0  # 수익 구간 확인

      조건 3: PYRAMID_COUNT < MAX_PYRAMID_COUNT  # 횟수 제한 확인

      ```


      ### 진입가 기준 불타기 구현


      **상승 추세 불타기:**

      ```

      불타기 설정:

      - 기준점: 최초 진입가 (AVG_BUY_PRICE 초기값)

      - 간격: 5.0% (진입가 대비)

      - 방향: 상향 추적

      - 최대 횟수: 4회


      실행 조건:

      1차: CURRENT_PRICE >= 진입가 × 1.05

      2차: CURRENT_PRICE >= 진입가 × 1.10

      3차: CURRENT_PRICE >= 진입가 × 1.15

      4차: CURRENT_PRICE >= 진입가 × 1.20

      ```


      ### 평단가 기준 물타기 구현


      **하락 조정 물타기:**

      ```

      물타기 설정:

      - 기준점: 현재 평균매수가 (AVG_BUY_PRICE)

      - 간격: -3.0% (평단가 대비)

      - 방향: 하향 추적

      - 최대 횟수: 3회


      실행 조건:

      1차: CURRENT_PRICE <= AVG_BUY_PRICE × 0.97

      2차: CURRENT_PRICE <= 새로운_평단가 × 0.97

      3차: CURRENT_PRICE <= 새로운_평단가 × 0.97

      ```


      ### 조합 전략 구현


      **RSI + 피라미딩 조합:**

      ```

      진입 조건:

      - RSI < 30  # 과매도 구간 첫 진입

      - CURRENT_PRICE < BOLLINGER_BAND_LOWER


      피라미딩 활성화:

      - 첫 진입 후 META_PYRAMID_TARGET 활성화

      - 진입가 기준 5% 간격 불타기 설정

      - RSI > 70 도달시 피라미딩 중단

      ```


      **볼린저밴드 + 물타기 조합:**

      ```

      진입 조건:

      - CURRENT_PRICE <= BOLLINGER_BAND_LOWER

      - VOLUME > VOLUME_SMA(20) × 1.5


      물타기 전략:

      - 하한선 진입 후 평단가 기준 -3% 물타기

      - 중간선 도달시 물타기 중단

      - 최대 3회 제한으로 리스크 관리

      ```


      ### 동적 간격 조정 전략


      **변동성 기반 간격 설정:**

      ```

      동적 간격 = 고정간격 × (ATR / CURRENT_PRICE × 100)


      예시:

      기본 간격 5%, ATR이 평상시 2배일 때

      → 실제 간격 = 5% × 2 = 10%


      고변동성시 더 넓은 간격으로 조기 신호 방지

      ```


      ### 리스크 관리 조건


      **안전장치 설정:**

      ```

      피라미딩 중단 조건:

      - TOTAL_INVESTMENT > TOTAL_BALANCE × 0.5  # 총 투자 50% 초과

      - CONSECUTIVE_LOSS > 3  # 연속 3회 손실

      - MARKET_TREND = "BEARISH"  # 하락 추세 확인


      강제 청산 조건:

      - CURRENT_PRICE < FIRST_ENTRY_PRICE × 0.85  # 최초 진입가 대비 15% 손실

      ```

      '
