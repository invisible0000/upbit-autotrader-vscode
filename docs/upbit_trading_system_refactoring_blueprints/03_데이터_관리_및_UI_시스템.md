# ì—…ë¹„íŠ¸ ìë™ë§¤ë§¤ ì‹œìŠ¤í…œ í†µí•© ì²­ì‚¬ì§„ v2.2 - 03: ë°ì´í„° ê´€ë¦¬ ë° UI ì‹œìŠ¤í…œ

## ë°ì´í„° ê´€ë¦¬ ì‹œìŠ¤í…œ (95% ì™„ë£Œ)

### ğŸ—„ï¸ 3-Database ì•„í‚¤í…ì²˜ (ìµœì¢… í™•ì •)

í˜„ì¬ ì‹œìŠ¤í…œì€ ì—­í• ë³„ë¡œ ë¶„ë¦¬ëœ 3ê°œì˜ SQLite ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©°, `config/database_paths.py`ì—ì„œ ì¤‘ì•™ ì§‘ì¤‘ ê´€ë¦¬ë©ë‹ˆë‹¤.

```python
# ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° (í™•ì •ëœ ìµœì¢… í˜•íƒœ)
DATABASE_STRUCTURE = {
    "settings.sqlite3": {
        "purpose": "ì‹œìŠ¤í…œ ì„¤ì • + ê±°ë˜ë³€ìˆ˜ ì •ì˜",
        "tables": 17,  # cfg_*, tv_*, sys_* ì ‘ë‘ì‚¬
        "examples": ["tv_trading_variables", "cfg_app_settings", "sys_backup_info"]
    },
    "strategies.sqlite3": {
        "purpose": "ì‚¬ìš©ì ì „ëµ + ì‹¤í–‰ ë°ì´í„°", 
        "tables": 16,  # strategies, trading_conditions, user_* ë“±
        "examples": ["strategies", "trading_conditions", "execution_history"]
    },
    "market_data.sqlite3": {
        "purpose": "ì‹œì¥ ë°ì´í„° + ì°¨íŠ¸ ì •ë³´",
        "tables": 20,  # candlestick_*, technical_*, real_time_* ë“±  
        "examples": ["candlestick_data_1d", "technical_indicators_1h", "real_time_quotes"]
    }
}
```

### ğŸ“Š í…Œì´ë¸” ë§¤í•‘ ì‹œìŠ¤í…œ
```python
# TableMappings í´ë˜ìŠ¤ë¡œ 53ê°œ í…Œì´ë¸”ì˜ ì •í™•í•œ DB í• ë‹¹
class TableMappings:
    @classmethod
    def get_db_for_table(cls, table_name: str) -> str:
        """í…Œì´ë¸”ëª…ì— ë”°ë¼ ì ì ˆí•œ ë°ì´í„°ë² ì´ìŠ¤ ê²½ë¡œ ë°˜í™˜"""
        if table_name in cls.SETTINGS_TABLES:
            return str(DatabasePaths.SETTINGS_DB)
        elif table_name in cls.STRATEGIES_TABLES:
            return str(DatabasePaths.STRATEGIES_DB)
        elif table_name in cls.MARKET_DATA_TABLES:
            return str(DatabasePaths.MARKET_DATA_DB)

# ì‚¬ìš© ì˜ˆì‹œ
db_path = TableMappings.get_db_for_table('trading_conditions')
# â†’ "data/strategies.sqlite3"
```

### ğŸ”§ ì „ì—­ ë°ì´í„°ë² ì´ìŠ¤ ë§¤ë‹ˆì € (ì™„ë£Œ)
```python
# utils/global_db_manager.py - ì‹±ê¸€í†¤ íŒ¨í„´ìœ¼ë¡œ ì—°ê²° ê´€ë¦¬
class DatabaseManager:
    def __init__(self):
        self._connections: Dict[str, sqlite3.Connection] = {}
        self._db_paths = {}
        self._table_mappings = {}
        
    def get_connection(self, table_name: str) -> sqlite3.Connection:
        """í…Œì´ë¸”ëª…ìœ¼ë¡œ ì ì ˆí•œ DB ì—°ê²° ë°˜í™˜"""
        db_name = self._table_mappings.get(table_name)
        if db_name not in self._connections:
            self._connections[db_name] = sqlite3.connect(self._db_paths[db_name])
        return self._connections[db_name]

# ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
db_manager = DatabaseManager()
```

### ğŸ“ ë°ì´í„° ë°±ì—… ë° ë³µì› ì‹œìŠ¤í…œ
```python
# data_layer/storage/backup_manager.py
class BackupManager:
    def backup_sqlite(self, backup_name: Optional[str] = None) -> str:
        """3ê°œ DB íŒŒì¼ì„ í†µí•© ë°±ì—…"""
        
    def restore_from_backup(self, backup_path: str) -> bool:
        """ë°±ì—…ì—ì„œ ë³µì›"""
        
    def create_migration_backup(self) -> str:
        """ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ ì•ˆì „ ë°±ì—…"""
```

## UI ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ (80% ì™„ë£Œ)

### ğŸ–¥ï¸ ë°ìŠ¤í¬í†± UI êµ¬ì¡° (PyQt6 ê¸°ë°˜)

```
ui/desktop/
â”œâ”€â”€ ğŸ“± ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ main_window.py           # ë©”ì¸ ìœˆë„ìš° í”„ë ˆì„ì›Œí¬
â”‚   â””â”€â”€ navigation_bar.py        # í™”ë©´ ê°„ ë„¤ë¹„ê²Œì´ì…˜
â”œâ”€â”€ ğŸ“Š í™”ë©´ë³„ ì»´í¬ë„ŒíŠ¸ (screens/)
â”‚   â”œâ”€â”€ dashboard/               # ëŒ€ì‹œë³´ë“œ (90% ì™„ë£Œ)
â”‚   â”‚   â”œâ”€â”€ portfolio_summary.py     # í¬íŠ¸í´ë¦¬ì˜¤ ìš”ì•½ ìœ„ì ¯
â”‚   â”‚   â”œâ”€â”€ active_trades.py         # í™œì„± ê±°ë˜ ëª©ë¡
â”‚   â”‚   â””â”€â”€ market_overview.py       # ì‹œì¥ ê°œìš” ìœ„ì ¯
â”‚   â”œâ”€â”€ strategy_management/     # ì „ëµ ê´€ë¦¬ (75% ì™„ë£Œ)
â”‚   â”‚   â”œâ”€â”€ strategy_maker.py        # ì „ëµ ìƒì„± ì¸í„°í˜ì´ìŠ¤
â”‚   â”‚   â””â”€â”€ trigger_builder/         # íŠ¸ë¦¬ê±° ë¹Œë” ì‹œìŠ¤í…œ
â”‚   â”œâ”€â”€ chart_view/             # ì°¨íŠ¸ ë·° (90% ì™„ë£Œ)
â”‚   â”‚   â”œâ”€â”€ candlestick_chart.py     # ìº”ë“¤ìŠ¤í‹± ì°¨íŠ¸
â”‚   â”‚   â”œâ”€â”€ indicator_overlay.py     # ê¸°ìˆ ì  ì§€í‘œ ì˜¤ë²„ë ˆì´
â”‚   â”‚   â””â”€â”€ trade_marker.py          # ê±°ë˜ ì‹œì  ë§ˆì»¤
â”‚   â””â”€â”€ settings/               # ì„¤ì • í™”ë©´ (95% ì™„ë£Œ)
â”‚       â”œâ”€â”€ database_settings.py     # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
â”‚       â””â”€â”€ api_settings.py          # API í‚¤ ê´€ë¦¬
â””â”€â”€ ğŸ§© ê³µí†µ ì»´í¬ë„ŒíŠ¸ (common/)
    â”œâ”€â”€ base_widget.py          # ê¸°ë³¸ ìœ„ì ¯ í´ë˜ìŠ¤
    â”œâ”€â”€ theme_manager.py        # ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ
    â””â”€â”€ chart_components.py     # ê³µí†µ ì°¨íŠ¸ ìš”ì†Œ
```

### âœ… ì™„ì„±ëœ UI ê¸°ëŠ¥ë“¤

#### 1. ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ (90% ì™„ë£Œ)
```python
# screens/dashboard/ - ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ í™”ë©´
class DashboardScreen:
    def __init__(self):
        self.portfolio_widget = PortfolioSummaryWidget()    # ë„ë„› ì°¨íŠ¸ë¡œ ìì‚° êµ¬ì„± í‘œì‹œ
        self.trades_widget = ActiveTradesWidget()           # í˜„ì¬ í¬ì§€ì…˜ ëª©ë¡
        self.market_widget = MarketOverviewWidget()         # ì£¼ìš” ì½”ì¸ ì‹œì„¸
        
    def setup_auto_refresh(self):
        """5ì´ˆ ì£¼ê¸° ìë™ ë°ì´í„° ê°±ì‹ """
        self.timer = QTimer()
        self.timer.timeout.connect(self.refresh_all_data)
        self.timer.start(5000)  # 5ì´ˆë§ˆë‹¤ ê°±ì‹ 
```

#### 2. ì°¨íŠ¸ ì‹œê°í™” ì‹œìŠ¤í…œ (90% ì™„ë£Œ)
```python
# screens/chart_view/ - ê³ ê¸‰ ì°¨íŠ¸ ë¶„ì„ ë„êµ¬
class ChartViewScreen:
    def __init__(self):
        self.candlestick_chart = CandlestickChart()         # ê¸°ë³¸ ìº”ë“¤ì°¨íŠ¸
        self.indicator_overlay = IndicatorOverlay()         # SMA, EMA, ë³¼ë¦°ì €ë°´ë“œ
        self.trade_marker = TradeMarker()                   # ë§¤ìˆ˜/ë§¤ë„ ì‹œì  í‘œì‹œ
        
    def supported_indicators(self):
        return ["SMA", "EMA", "Bollinger Bands", "RSI", "MACD", "Stochastic"]
    
    def supported_timeframes(self):
        return ["1m", "5m", "15m", "1h", "4h", "1d", "1w"]
```

#### 3. ì „ëµ ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤ (75% ì™„ë£Œ)
```python
# screens/strategy_management/ - ì „ëµ ìƒì„± ë° ê´€ë¦¬
class StrategyManagementScreen:
    def __init__(self):
        self.strategy_maker = StrategyMaker()               # ì „ëµ ìƒì„± ë„êµ¬
        self.trigger_builder = TriggerBuilderSystem()       # íŠ¸ë¦¬ê±° ì¡°ê±´ ì„¤ì •
        self.backtest_runner = BacktestInterface()          # ë°±í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        
class TriggerBuilderSystem:
    """ë“œë˜ê·¸ì•¤ë“œë¡­ ë°©ì‹ì˜ íŠ¸ë¦¬ê±° ì¡°ê±´ ì„¤ì •"""
    def __init__(self):
        self.variable_selector = VariableSelector()         # ê±°ë˜ë³€ìˆ˜ ì„ íƒ
        self.parameter_builder = ParameterBuilder()         # íŒŒë¼ë¯¸í„° ì„¤ì •
        self.condition_storage = ConditionStorage()         # ì¡°ê±´ ì €ì¥
```

### ğŸš§ ê°œë°œ ì¤‘ì¸ UI ê¸°ëŠ¥ë“¤

#### 1. ê³ ê¸‰ ì „ëµ ë¹Œë” (50% ì™„ë£Œ)
```python
# ëª©í‘œ: ì‹œê°ì  ì „ëµ ì„¤ê³„ ë„êµ¬
class VisualStrategyBuilder:
    def __init__(self):
        self.component_palette = ComponentPalette()         # ì»´í¬ë„ŒíŠ¸ íŒ”ë ˆíŠ¸
        self.canvas = StrategyCanvas()                      # ë“œë˜ê·¸ì•¤ë“œë¡­ ìº”ë²„ìŠ¤
        self.flow_validator = StrategyFlowValidator()       # ì „ëµ íë¦„ ê²€ì¦
        
    def drag_and_drop_workflow(self):
        """ì»´í¬ë„ŒíŠ¸ë¥¼ ë“œë˜ê·¸í•˜ì—¬ ì „ëµ í”Œë¡œìš° êµ¬ì„±"""
        # 1. íŠ¸ë¦¬ê±° ì„ íƒ ë° ë°°ì¹˜
        # 2. ì¡°ê±´ ì¶”ê°€ ë° ì—°ê²°  
        # 3. ì•¡ì…˜ ì„¤ì • ë° ì—°ê²°
        # 4. ì „ëµ ê²€ì¦ ë° ì €ì¥
```

#### 2. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ (40% ì™„ë£Œ)
```python
# ëª©í‘œ: ì‹¤ê±°ë˜ ëª¨ë‹ˆí„°ë§ ì „ìš© í™”ë©´
class LiveTradingDashboard:
    def __init__(self):
        self.position_monitor = PositionMonitor()          # í¬ì§€ì…˜ ì‹¤ì‹œê°„ ì¶”ì 
        self.pnl_tracker = PnLTracker()                    # ì†ìµ ì‹¤ì‹œê°„ ê³„ì‚°
        self.alert_center = AlertCenter()                  # ì•Œë¦¼ ì¤‘ì•™ ê´€ë¦¬
        self.risk_meter = RiskMeter()                      # ë¦¬ìŠ¤í¬ ì§€í‘œ í‘œì‹œ
```

#### 3. ì›¹ ì¸í„°í˜ì´ìŠ¤ (ê³„íš ë‹¨ê³„)
```python
# ui/web/ - í–¥í›„ ì›¹ ì ‘ê·¼ ì§€ì›
class WebInterface:
    """Flask/FastAPI ê¸°ë°˜ ì›¹ ëŒ€ì‹œë³´ë“œ"""
    def __init__(self):
        self.api_server = APIServer()                      # RESTful API ì„œë²„
        self.websocket_handler = WebSocketHandler()        # ì‹¤ì‹œê°„ ë°ì´í„° ì „ì†¡
        self.web_dashboard = WebDashboard()                # ì›¹ ëŒ€ì‹œë³´ë“œ UI
```

## ë°ì´í„° íë¦„ ë° ë™ê¸°í™”

### ğŸ“Š ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸
```
1. ì—…ë¹„íŠ¸ API â†’ 2. ë°ì´í„° ìˆ˜ì§‘ê¸° â†’ 3. ì „ì²˜ë¦¬ â†’ 4. DB ì €ì¥ â†’ 5. UI ê°±ì‹ 
   â†“              â†“              â†“         â†“          â†“
WebSocket     DataCollector  Validator  DBManager  SignalBus
```

### ğŸ”„ UI-ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë™ê¸°í™” (ì–´ëŒ‘í„° íŒ¨í„´)
```python
# UI ì–´ëŒ‘í„°ê°€ UI ì´ë²¤íŠ¸ë¥¼ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”ì²­ìœ¼ë¡œ ë³€í™˜
class UIEventAdapter:
    def __init__(self):
        self.strategy_service = StrategyService()
        self.trading_service = TradingService()
        
    def handle_strategy_save(self, ui_form_data):
        """ì „ëµ ì €ì¥ ì´ë²¤íŠ¸ ì²˜ë¦¬"""
        business_request = self._convert_form_to_strategy(ui_form_data)
        validation_result = self.strategy_service.validate_strategy(business_request)
        
        if validation_result.is_valid:
            strategy_id = self.strategy_service.save_strategy(business_request)
            return {"success": True, "strategy_id": strategy_id}
        else:
            return {"success": False, "errors": validation_result.errors}
    
    def handle_trade_execution(self, trade_request):
        """ê±°ë˜ ì‹¤í–‰ ì´ë²¤íŠ¸ ì²˜ë¦¬"""
        return self.trading_service.execute_trade(trade_request)
```

### ğŸ“¢ ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹  ì‹œìŠ¤í…œ
```python
# ì»´í¬ë„ŒíŠ¸ ê°„ ëŠìŠ¨í•œ ê²°í•©ì„ ìœ„í•œ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ
class EventBus:
    def __init__(self):
        self.subscribers = {}
        
    def subscribe(self, event_type: str, handler: callable):
        """ì´ë²¤íŠ¸ êµ¬ë…"""
        
    def publish(self, event_type: str, data: any):
        """ì´ë²¤íŠ¸ ë°œí–‰"""
        
# ì‚¬ìš© ì˜ˆì‹œ
event_bus.subscribe("position_updated", dashboard.refresh_positions)
event_bus.subscribe("new_signal", trading_engine.process_signal)
event_bus.publish("trade_executed", trade_result)
```

## ì„±ëŠ¥ ìµœì í™” ë° ì‚¬ìš©ì ê²½í—˜

### âš¡ ì°¨íŠ¸ ë Œë”ë§ ìµœì í™”
```python
# ëŒ€ìš©ëŸ‰ ì°¨íŠ¸ ë°ì´í„° íš¨ìœ¨ì  ì²˜ë¦¬
class OptimizedChartRenderer:
    def __init__(self):
        self.viewport_manager = ViewportManager()          # ë·°í¬íŠ¸ ê¸°ë°˜ ë Œë”ë§
        self.data_sampler = DataSampler()                  # ë°ì´í„° ìƒ˜í”Œë§
        self.cache_manager = ChartCacheManager()           # ì°¨íŠ¸ ìºì‹œ ê´€ë¦¬
        
    def render_candlesticks(self, data, viewport):
        """ë·°í¬íŠ¸ì— ë³´ì´ëŠ” ì˜ì—­ë§Œ ë Œë”ë§"""
        visible_data = self.viewport_manager.get_visible_data(data, viewport)
        sampled_data = self.data_sampler.sample_for_viewport(visible_data)
        return self.cache_manager.get_or_render(sampled_data)
```

### ğŸ¨ í…Œë§ˆ ë° ì‚¬ìš©ì ì„¤ì •
```python
# ë‹¤í¬/ë¼ì´íŠ¸ ëª¨ë“œ ë° ì‚¬ìš©ì ì»¤ìŠ¤í„°ë§ˆì´ì§•
class ThemeManager:
    def __init__(self):
        self.current_theme = "dark"  # default
        self.custom_colors = {}
        
    def apply_theme(self, theme_name: str):
        """ì‹œìŠ¤í…œ ì „ì²´ í…Œë§ˆ ì ìš©"""
        
    def save_user_preferences(self, preferences: dict):
        """ì‚¬ìš©ì ì„¤ì • ì €ì¥"""
        
# ì§€ì› í…Œë§ˆ
AVAILABLE_THEMES = {
    "dark": {"bg": "#2b2b2b", "text": "#ffffff", "accent": "#007acc"},
    "light": {"bg": "#ffffff", "text": "#000000", "accent": "#0078d4"},
    "trading": {"bg": "#1a1a1a", "text": "#00ff00", "accent": "#ff4444"}  # ê±°ë˜ íŠ¹í™”
}
```

## ê°œë°œ ìš°ì„ ìˆœìœ„ ë° ì™„ì„± ê³„íš

### ğŸ¯ Phase 1: UI ì‹œìŠ¤í…œ ì™„ì„± (3ì£¼)
- [ ] **ì‹œê°ì  ì „ëµ ë¹Œë”**: ë“œë˜ê·¸ì•¤ë“œë¡­ ë°©ì‹ ì „ëµ ì„¤ê³„ ë„êµ¬
- [ ] **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**: ê±°ë˜ ì¤‘ í¬ì§€ì…˜/ì†ìµ ì‹¤ì‹œê°„ ì¶”ì 
- [ ] **ì•Œë¦¼ ì‹œìŠ¤í…œ**: ì¤‘ìš” ì´ë²¤íŠ¸ ì•Œë¦¼ (ê°€ê²© ë„ë‹¬, ê±°ë˜ ì²´ê²° ë“±)
- [ ] **ì°¨íŠ¸ ê³ ë„í™”**: ë” ë§ì€ ê¸°ìˆ ì  ì§€í‘œ, íŒ¨í„´ ì¸ì‹ ê¸°ëŠ¥
- [ ] **ì‚¬ìš©ì ì„¤ì •**: ê°œì¸í™”ëœ UI ë ˆì´ì•„ì›ƒ ë° í…Œë§ˆ

### ğŸ¯ Phase 2: ë°ì´í„° ì‹œìŠ¤í…œ ê³ ë„í™” (2ì£¼)  
- [ ] **ë°ì´í„° ë¶„ì„ ë„êµ¬**: ê±°ë˜ ì„±ê³¼ ìƒì„¸ ë¶„ì„ ë° ë³´ê³ ì„œ
- [ ] **ë°±ì—… ìë™í™”**: ì •ê¸°ì  ìë™ ë°±ì—… ë° í´ë¼ìš°ë“œ ë™ê¸°í™”
- [ ] **ë°ì´í„° ì••ì¶•**: ì¥ê¸°ê°„ ë°ì´í„° íš¨ìœ¨ì  ì €ì¥
- [ ] **ì™¸ë¶€ ë°ì´í„°**: ë‰´ìŠ¤, SNS ê°ì • ë¶„ì„ ë°ì´í„° í†µí•©
- [ ] **ë°ì´í„° í’ˆì§ˆ**: ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ë° ìë™ ë³µêµ¬

### ğŸ¯ Phase 3: í†µí•© ë° ë°°í¬ ì¤€ë¹„ (1ì£¼)
- [ ] **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì„±ëŠ¥ ê²€ì¦
- [ ] **ì‚¬ìš©ì í…ŒìŠ¤íŠ¸**: ì‹¤ì œ ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘ ë° ê°œì„ 
- [ ] **ë¬¸ì„œí™”**: ì‚¬ìš©ì ê°€ì´ë“œ ë° ê°œë°œì ë¬¸ì„œ ì™„ì„±
- [ ] **ë°°í¬ íŒ¨í‚¤ì§•**: ì„¤ì¹˜í˜• í”„ë¡œê·¸ë¨ ë¹Œë“œ ë° ë°°í¬ ì¤€ë¹„
- [ ] **ë²„ì „ ê´€ë¦¬**: ì—…ë°ì´íŠ¸ ì‹œìŠ¤í…œ ë° ë¡¤ë°± ê¸°ëŠ¥

ì´ ë°ì´í„° ê´€ë¦¬ ë° UI ì‹œìŠ¤í…œì€ ì‚¬ìš©ì ì¹œí™”ì ì´ë©´ì„œë„ ì „ë¬¸ì ì¸ ê±°ë˜ ë„êµ¬ë¥¼ ì œê³µí•˜ë©°, í™•ì¥ì„±ê³¼ ì„±ëŠ¥ì„ ëª¨ë‘ ê³ ë ¤í•œ ì„¤ê³„ì…ë‹ˆë‹¤.
