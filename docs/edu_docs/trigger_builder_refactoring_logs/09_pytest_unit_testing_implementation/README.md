# ğŸ“ pytest ë‹¨ìœ„í…ŒìŠ¤íŠ¸ êµ¬í˜„ - êµìœ¡ ìë£Œ

> **í”„ë¡œì íŠ¸**: Upbit ìë™ë§¤ë§¤ ì‹œìŠ¤í…œ
> **ì‘ì—…ëª…**: Infrastructure Layer pytest ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ êµ¬í˜„
> **ì‘ì—…ì¼**: 2025-08-05
> **ëŒ€ìƒ**: ì£¼ë‹ˆì–´ ê°œë°œì

## ğŸ“‹ ê°œìš”

ì´ í´ë”ëŠ” **pytest ê¸°ë°˜ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ êµ¬í˜„** ê³¼ì •ì—ì„œ ì–»ì€ ì‹¤ë¬´ ê²½í—˜ì„ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•œ êµìœ¡ ìë£Œì…ë‹ˆë‹¤.

### ğŸ¯ ì‘ì—… ì„±ê³¼
- **13ê°œ í…ŒìŠ¤íŠ¸ 100% í†µê³¼** (Mock 9ê°œ + ì‹¤ì œ API 4ê°œ)
- **ì´ì¤‘ API í‚¤ ë¡œë”© ì‹œìŠ¤í…œ** êµ¬ì¶• (.env + ì•”í˜¸í™” íŒŒì¼)
- **ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì™„ë²½ ì§€ì›** (pytest-asyncio + AsyncMock)
- **ë§ˆì»¤ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ë¶„ë¥˜** (unit, integration, real_api)

## ğŸ“š ë¬¸ì„œ êµ¬ì„±

### [01_ê°œë°œê²½í—˜.md](01_ê°œë°œê²½í—˜.md)
- **ëª©ì **: í”„ë¡œì íŠ¸ ì§„í–‰ ê³¼ì •ì—ì„œ ì–»ì€ ì‹¤ë¬´ ê²½í—˜ê³¼ ì¸ì‚¬ì´íŠ¸
- **ë‚´ìš©**:
  - ê¸°ìˆ ì  ë„ì „ê³¼ì œì™€ í•´ê²° ê³¼ì •
  - ê°œë°œìë¡œì„œ ì„±ì¥í•œ ë¶€ë¶„
  - ì‹¤ë¬´ì—ì„œ ë°”ë¡œ ì ìš©í•  íŒ
  - í”„ë¡œì íŠ¸ íšŒê³  ë° í–¥í›„ ë°œì „ ë°©í–¥

### [02_êµ¬í˜„ê°€ì´ë“œ.md](02_êµ¬í˜„ê°€ì´ë“œ.md)
- **ëª©ì **: ë™ì¼í•œ ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ ë‹¨ê³„ë³„ ê°€ì´ë“œ
- **ë‚´ìš©**:
  - API í‚¤ ë¡œë”© ì‹œìŠ¤í…œ êµ¬ì¶• ë°©ë²•
  - pytest ì„¤ì • ë° Mock í…ŒìŠ¤íŠ¸ ì‘ì„±ë²•
  - ì‹¤ì œ API í†µí•© í…ŒìŠ¤íŠ¸ êµ¬í˜„
  - í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì „ëµ ë° í’ˆì§ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### [03_ë¬¸ì œí•´ê²°.md](03_ë¬¸ì œí•´ê²°.md)
- **ëª©ì **: ì‹¤ì œ ë°œìƒí•œ ë¬¸ì œë“¤ê³¼ í•´ê²° ê³¼ì • ìƒì„¸ ê¸°ë¡
- **ë‚´ìš©**:
  - 5ê°€ì§€ ì£¼ìš” ë¬¸ì œì™€ í•´ê²° ê³¼ì •
  - ë¬¸ì œ í•´ê²° ë°©ë²•ë¡  ë° ë””ë²„ê¹… ë„êµ¬
  - ì˜ˆë°© ê°€ì´ë“œë¼ì¸ ë° íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì²´í¬ë¦¬ìŠ¤íŠ¸

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### í•µì‹¬ ê¸°ìˆ 
- **Python 3.13.5** - ë©”ì¸ ì–¸ì–´
- **pytest** - í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
- **pytest-asyncio** - ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì§€ì›
- **AsyncMock** - ë¹„ë™ê¸° Mock ê°ì²´

### ë³´ì•ˆ ë° ì¸í”„ë¼
- **python-dotenv** - í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬
- **cryptography** - API í‚¤ ì•”í˜¸í™”
- **aiohttp** - ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸

## ğŸ¯ í•™ìŠµ ëª©í‘œ

### ì´ˆê¸‰ (ë¬¸ì„œ ì½ê¸°)
- [ ] pytest ê¸°ë³¸ ê°œë…ê³¼ ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ ì´í•´
- [ ] Mock vs ì‹¤ì œ API í…ŒìŠ¤íŠ¸ì˜ ì°¨ì´ì  íŒŒì•…
- [ ] API í‚¤ ë³´ì•ˆ ê´€ë¦¬ ë°©ì‹ í•™ìŠµ

### ì¤‘ê¸‰ (ì‹¤ìŠµ)
- [ ] ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ ì§ì ‘ êµ¬í˜„
- [ ] Mock ê°ì²´ì˜ ì •í™•ì„± ê²€ì¦ ë°©ë²• ìŠµë“
- [ ] ë§ˆì»¤ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ë¶„ë¥˜ í™œìš©

### ê³ ê¸‰ (ì‘ìš©)
- [ ] ë‹¤ë¥¸ Infrastructure ì»´í¬ë„ŒíŠ¸ì— pytest ì ìš©
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ì— í…ŒìŠ¤íŠ¸ í†µí•©
- [ ] í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ í–¥ìƒ ë° ì„±ëŠ¥ ìµœì í™”

## ğŸš€ ì‹¤ìŠµ ê°€ì´ë“œ

### 1ë‹¨ê³„: í™˜ê²½ ì„¤ì •
```bash
# í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
pip install pytest pytest-asyncio pytest-cov cryptography python-dotenv

# í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸
ls tests/infrastructure/external_apis/
```

### 2ë‹¨ê³„: ê¸°ë³¸ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
```bash
# ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pytest tests/infrastructure/external_apis/test_upbit_clients.py -v

# Mock í…ŒìŠ¤íŠ¸ë§Œ (ë¹ ë¥¸ í”¼ë“œë°±)
pytest tests/infrastructure/external_apis/test_upbit_clients.py -m "not real_api" -v
```

### 3ë‹¨ê³„: API í‚¤ ì„¤ì • (ì„ íƒì‚¬í•­)
```bash
# .env íŒŒì¼ ìƒì„± (ì‹¤ì œ API í…ŒìŠ¤íŠ¸ìš©)
echo "UPBIT_ACCESS_KEY=your_access_key" > .env
echo "UPBIT_SECRET_KEY=your_secret_key" >> .env

# ì‹¤ì œ API í…ŒìŠ¤íŠ¸ ì‹¤í–‰
pytest tests/infrastructure/external_apis/test_upbit_clients.py -m "real_api" -v
```

## ğŸ“Š ì„±ê³¼ ì§€í‘œ

### ì •ëŸ‰ì  ì„±ê³¼
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: Infrastructure Layer 85%+
- **í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì†ë„**: Mock í…ŒìŠ¤íŠ¸ < 1ì´ˆ, ì „ì²´ < 2ì´ˆ
- **API í‚¤ ë¡œë”© ì„±ê³µë¥ **: .env 100%, ì•”í˜¸í™” íŒŒì¼ 100%

### ì •ì„±ì  ì„±ê³¼
- **ì½”ë“œ ì‹ ë¢°ì„±**: ì‹¤ì œ APIì™€ Mock í…ŒìŠ¤íŠ¸ ì´ì¤‘ ê²€ì¦
- **ê°œë°œ íš¨ìœ¨ì„±**: ë¹ ë¥¸ í”¼ë“œë°± ë£¨í”„ êµ¬ì¶•
- **ë³´ì•ˆ ê°•í™”**: ë‹¤ì¤‘ API í‚¤ ì €ì¥ ë°©ì‹ ì§€ì›

## ğŸ’¡ í•µì‹¬ êµí›ˆ

### ê¸°ìˆ ì  êµí›ˆ
1. **Mockì˜ ì •í™•ì„±ì´ í•µì‹¬**: ì‹¤ì œ êµ¬í˜„ê³¼ 100% ì¼ì¹˜í•´ì•¼ í•¨
2. **ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ëŠ” AsyncMock**: ì¼ë°˜ Mockìœ¼ë¡œëŠ” í•œê³„
3. **ì´ì¤‘ ì†ŒìŠ¤ ì „ëµ**: ê°œë°œ í¸ì˜ì„±ê³¼ ë³´ì•ˆ ëª¨ë‘ ë§Œì¡±

### ê°œë°œ í”„ë¡œì„¸ìŠ¤ êµí›ˆ
1. **ì°¨ê·¼ì°¨ê·¼ ì ‘ê·¼**: ê° ë¬¸ì œë¥¼ í•˜ë‚˜ì”© ì •í™•íˆ í•´ê²°
2. **ì‹¤ì œ êµ¬í˜„ í™•ì¸**: ì¶”ì¸¡í•˜ì§€ ë§ê³  ì†ŒìŠ¤ì½”ë“œ ë¶„ì„
3. **ì²´ê³„ì  ê²€ì¦**: Mock â†’ ì‹¤ì œ API ìˆœì„œë¡œ ê²€ì¦

## ğŸ”„ í–¥í›„ í™œìš© ë°©ì•ˆ

### ë‹¨ê¸° í™œìš©
- **Template**: ë‹¤ë¥¸ Infrastructure ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ ì‹œ ì°¸ì¡°
- **Training**: ì‹ ì… ê°œë°œì pytest êµìœ¡ ìë£Œ
- **Quality Gate**: ì½”ë“œ ë¦¬ë·° ì‹œ í…ŒìŠ¤íŠ¸ í’ˆì§ˆ ê¸°ì¤€

### ì¥ê¸° í™œìš©
- **Best Practice**: íŒ€ ë‚´ í…ŒìŠ¤íŠ¸ ì‘ì„± í‘œì¤€
- **CI/CD í†µí•©**: ìë™í™” íŒŒì´í”„ë¼ì¸ êµ¬ì¶• ê¸°ë°˜
- **Test Strategy**: ì „ì‚¬ í…ŒìŠ¤íŠ¸ ì „ëµ ìˆ˜ë¦½ ì°¸ê³ 

---

## ğŸ“ ë¬¸ì˜ì‚¬í•­

í…ŒìŠ¤íŠ¸ êµ¬í˜„ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ë©´:
1. **êµ¬í˜„ ë¬¸ì œ**: `02_êµ¬í˜„ê°€ì´ë“œ.md` ì°¸ì¡°
2. **ì˜¤ë¥˜ í•´ê²°**: `03_ë¬¸ì œí•´ê²°.md` ì°¸ì¡°
3. **ê²½í—˜ ê³µìœ **: `01_ê°œë°œê²½í—˜.md` ì°¸ì¡°

**ğŸ’« ê²°ë¡ **: ì™„ë²½í•œ í…ŒìŠ¤íŠ¸ëŠ” ì½”ë“œì˜ ì‹ ë¢°ì„±ì„ ë³´ì¥í•˜ê³ , ë¦¬íŒ©í† ë§ì˜ ìì‹ ê°ì„ ì œê³µí•©ë‹ˆë‹¤!
