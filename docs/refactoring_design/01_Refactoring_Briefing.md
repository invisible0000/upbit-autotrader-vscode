# ğŸš€ ì—…ë¹„íŠ¸ ìë™ë§¤ë§¤ ì‹œìŠ¤í…œ ë¦¬íŒ©í† ë§ ê³„íš ë¸Œë¦¬í•‘

## ğŸ“‹ ë¬¸ì„œ ê°œìš”

**ì‘ì„±ì¼**: 2025ë…„ 8ì›” 3ì¼  
**ë¬¸ì„œ ëª©ì **: Clean Architecture ì ìš©ì„ í†µí•œ ëŒ€ê·œëª¨ ì‹œìŠ¤í…œ ë¦¬íŒ©í† ë§ ì´ê´„ ê³„íšì„œ  
**ëŒ€ìƒ ë…ì**: í”„ë¡œì íŠ¸ ì˜¤ë„ˆ, ê°œë°œíŒ€, ì•„í‚¤í…íŠ¸  
**ì‹¤í–‰ ê¸°ì¤€**: ë³¸ ë¬¸ì„œì˜ ëª¨ë“  ë‹¨ê³„ì™€ ê²€ì¦ ë°©ì•ˆì€ ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ íƒœìŠ¤í¬ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.

---

## ğŸ¯ ë¦¬íŒ©í† ë§ì˜ í•µì‹¬ ì² í•™

### "ì •êµí•œ ë§¤ë§¤ ì „ëµ ì—†ì´ëŠ” ëª¨ë“  ê¸°ëŠ¥ì´ ë¬´ì˜ë¯¸í•˜ë‹¤"

ì´ ê¹¨ë‹¬ìŒì´ í”„ë¡œì íŠ¸ ì „ì²´ ë°©í–¥ì„ **'ë§¤ë§¤ ì „ëµ ê´€ë¦¬(Strategy Management)' ì¤‘ì‹¬**ìœ¼ë¡œ ì „í™˜ì‹œì¼°ìŠµë‹ˆë‹¤. ë¦¬íŒ©í† ë§ì˜ ëª¨ë“  ê²°ì •ì€ ì´ ì² í•™ì„ êµ¬í˜„í•˜ëŠ” ë° ìµœì í™”ë©ë‹ˆë‹¤.

### í•µì‹¬ ëª©í‘œ
1. **ì „ëµ ì¤‘ì‹¬ ì•„í‚¤í…ì²˜**: ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ë§¤ë§¤ ì „ëµ ì‹¤í–‰ì„ ìœ„í•´ ì¡´ì¬
2. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆœìˆ˜ì„±**: UIì™€ ì™„ì „íˆ ë¶„ë¦¬ëœ ë„ë©”ì¸ ë¡œì§
3. **í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°**: ìƒˆë¡œìš´ ì „ëµ ì¶”ê°€ê°€ 2ì‹œê°„ ë‚´ ì™„ë£Œ
4. **ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œ**: ì‹¤ì œ ìê¸ˆ ìš´ìš©ì— ì‚¬ìš© ê°€ëŠ¥í•œ ì•ˆì •ì„±

---

## ğŸš¨ í˜„ì¬ ìƒí™© ì§„ë‹¨

### ì£¼ìš” ë¬¸ì œì 
- **UI ë ˆì´ì–´ ê³¼ë¶€í•˜**: ì „ì²´ ê¸°ëŠ¥ì˜ 60%ê°€ UIì— ì§‘ì¤‘
- **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ì‚°**: ì¤‘ìš”í•œ ë¡œì§ì´ UI ì»´í¬ë„ŒíŠ¸ì— í˜¼ì¬
- **í…ŒìŠ¤íŠ¸ ë¶ˆê°€ëŠ¥**: UIì™€ ê²°í•©ëœ ë¡œì§ìœ¼ë¡œ ì¸í•œ í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€
- **í™•ì¥ì„± ë¶€ì¡±**: ìƒˆë¡œìš´ ì „ëµ ì¶”ê°€ ì‹œ UI ìˆ˜ì • í•„ìš”

### í˜„ì¬ ê°•ì  (ìœ ì§€í•´ì•¼ í•  ê²ƒë“¤)
- **3-DB ì•„í‚¤í…ì²˜**: ì´ë¯¸ ì™„ì„±ëœ ìš°ìˆ˜í•œ ë°ì´í„° ë¶„ë¦¬ êµ¬ì¡°
- **ê¸°ë³¸ 7ê·œì¹™ ì „ëµ**: ê²€ì¦ ê¸°ì¤€ìœ¼ë¡œ í™œìš©í•  ì™„ì „í•œ ì „ëµ í…œí”Œë¦¿
- **ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ UI**: PyQt6 ê¸°ë°˜ì˜ ëª¨ë“ˆí™”ëœ UI êµ¬ì¡°
- **ìŠ¤ë§ˆíŠ¸ ë¡œê¹… ì‹œìŠ¤í…œ**: ê°œë°œê³¼ ë””ë²„ê¹…ì— ìµœì í™”ëœ ë¡œê¹…

---

## ğŸ—ï¸ ëª©í‘œ ì•„í‚¤í…ì²˜: 5-Layer Clean Architecture

```
ğŸ“ ìµœì¢… ëª©í‘œ êµ¬ì¡°:
upbit_auto_trading/
â”œâ”€â”€ ğŸ¨ presentation/           # UI ê³„ì¸µ (Passive View)
â”‚   â”œâ”€â”€ desktop/              # PyQt6 UI (í‘œì‹œë§Œ ë‹´ë‹¹)
â”‚   â”œâ”€â”€ presenters/           # MVP íŒ¨í„´ Presenter
â”‚   â””â”€â”€ view_models/          # MVVM íŒ¨í„´ ViewModel
â”œâ”€â”€ ğŸš€ application/           # Application ê³„ì¸µ (Use Cases)
â”‚   â”œâ”€â”€ services/             # ë¹„ì¦ˆë‹ˆìŠ¤ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ dto/                  # ë°ì´í„° ì „ì†¡ ê°ì²´
â”‚   â””â”€â”€ commands/             # Command íŒ¨í„´
â”œâ”€â”€ ğŸ§  domain/                # Domain ê³„ì¸µ (í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤)
â”‚   â”œâ”€â”€ entities/             # ë„ë©”ì¸ ì—”í‹°í‹°
â”‚   â”œâ”€â”€ value_objects/        # ê°’ ê°ì²´
â”‚   â”œâ”€â”€ services/             # ë„ë©”ì¸ ì„œë¹„ìŠ¤
â”‚   â”œâ”€â”€ repositories/         # ì¶”ìƒ Repository
â”‚   â””â”€â”€ events/               # ë„ë©”ì¸ ì´ë²¤íŠ¸
â”œâ”€â”€ ğŸ”§ infrastructure/        # Infrastructure ê³„ì¸µ
â”‚   â”œâ”€â”€ repositories/         # êµ¬ì²´ Repository êµ¬í˜„
â”‚   â”œâ”€â”€ external_apis/        # ì™¸ë¶€ API í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ database/             # DB ì ‘ê·¼ ë¡œì§
â”‚   â””â”€â”€ messaging/            # ì´ë²¤íŠ¸ ë²„ìŠ¤
â””â”€â”€ ğŸ“Š shared/                # ê³µìœ  ê³„ì¸µ
    â”œâ”€â”€ utils/                # ê³µí†µ ìœ í‹¸ë¦¬í‹°
    â”œâ”€â”€ config/               # ì„¤ì • ê´€ë¦¬
    â””â”€â”€ exceptions/           # ì˜ˆì™¸ ì •ì˜
```

### ê³„ì¸µë³„ ì±…ì„ ì •ì˜

#### ğŸ¨ Presentation Layer (UI ê³„ì¸µ)
**ì—­í• **: ìˆœìˆ˜í•œ í‘œì‹œì™€ ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ë§Œ ë‹´ë‹¹
- UI ì»´í¬ë„ŒíŠ¸ ë Œë”ë§
- ì‚¬ìš©ì ì´ë²¤íŠ¸ Presenterë¡œ ì „ë‹¬
- Presenterë¡œë¶€í„° ë°›ì€ ë°ì´í„° í‘œì‹œ

#### ğŸš€ Application Layer (ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ)
**ì—­í• **: Use Case êµ¬í˜„ ë° ì™¸ë¶€ ìš”ì²­ ì¡°ì •
- ì „ëµ ìƒì„±, ìˆ˜ì •, ì‚­ì œ Use Case
- íŠ¸ë¦¬ê±° ë¹Œë” ì›Œí¬í”Œë¡œìš° ê´€ë¦¬
- ë°±í…ŒìŠ¤íŒ… ì‹¤í–‰ ì¡°ì •

#### ğŸ§  Domain Layer (ë„ë©”ì¸ ê³„ì¸µ)
**ì—­í• **: í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ê³¼ ë§¤ë§¤ ë¡œì§
- ì „ëµ í˜¸í™˜ì„± ê²€ì¦
- íŠ¸ë¦¬ê±° ì¡°ê±´ í‰ê°€
- í¬ì§€ì…˜ ê´€ë¦¬ ê·œì¹™

#### ğŸ”§ Infrastructure Layer (ì¸í”„ë¼ ê³„ì¸µ)
**ì—­í• **: ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™
- ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼
- Upbit API í†µì‹ 
- íŒŒì¼ ì‹œìŠ¤í…œ ê´€ë¦¬

---

## ğŸš€ ë‹¨ê³„ë³„ ë¦¬íŒ©í† ë§ ì‹¤í–‰ ê³„íš

### Phase 1: Domain Layer êµ¬ì¶• (2ì£¼)
**ëª©í‘œ**: ë§¤ë§¤ ì „ëµì˜ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆœìˆ˜í•œ ë„ë©”ì¸ ëª¨ë¸ë¡œ êµ¬í˜„

#### 1.1 ë„ë©”ì¸ ì—”í‹°í‹° ì„¤ê³„ (3ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ ë„ë©”ì¸ ëª¨ë¸ êµ¬í˜„**
   ```python
   # íŒŒì¼: domain/entities/strategy.py
   @dataclass
   class Strategy:
       strategy_id: StrategyId
       name: str
       entry_triggers: List[Trigger]
       exit_triggers: List[Trigger]
       management_rules: List[ManagementRule]
       
       def add_trigger(self, trigger: Trigger) -> None:
           """íŠ¸ë¦¬ê±° ì¶”ê°€ ì‹œ í˜¸í™˜ì„± ê²€ì¦"""
           if not self._is_compatible_trigger(trigger):
               raise IncompatibleTriggerError()
   ```

2. **íŠ¸ë¦¬ê±° ë„ë©”ì¸ ëª¨ë¸ êµ¬í˜„**
   ```python
   # íŒŒì¼: domain/entities/trigger.py
   @dataclass
   class Trigger:
       trigger_id: TriggerId
       variable: TradingVariable
       operator: ComparisonOperator
       target_value: Union[float, TradingVariable]
       
       def evaluate(self, market_data: MarketData) -> bool:
           """ì¡°ê±´ í‰ê°€ ë¡œì§"""
   ```

3. **ê°’ ê°ì²´ ì •ì˜**
   ```python
   # íŒŒì¼: domain/value_objects/strategy_id.py
   @dataclass(frozen=True)
   class StrategyId:
       value: str
       
       def __post_init__(self):
           if not self.value or len(self.value) < 3:
               raise InvalidStrategyIdError()
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**: `test_domain_entities.py` ì‘ì„±
  ```python
  def test_strategy_creation():
      # Given
      strategy_id = StrategyId("RSI_STRATEGY_001")
      rsi_trigger = create_rsi_trigger()
      
      # When
      strategy = Strategy(strategy_id, "RSI ì „ëµ", [rsi_trigger], [], [])
      
      # Then
      assert strategy.strategy_id.value == "RSI_STRATEGY_001"
      assert len(strategy.entry_triggers) == 1
  ```

- **ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ í…ŒìŠ¤íŠ¸**: `test_strategy_business_rules.py` ì‘ì„±
  ```python
  def test_incompatible_trigger_rejection():
      # Given
      strategy = create_basic_strategy()
      incompatible_trigger = create_incompatible_trigger()
      
      # When & Then
      with pytest.raises(IncompatibleTriggerError):
          strategy.add_trigger(incompatible_trigger)
  ```

#### 1.2 ë„ë©”ì¸ ì„œë¹„ìŠ¤ êµ¬í˜„ (4ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ í˜¸í™˜ì„± ì„œë¹„ìŠ¤**
   ```python
   # íŒŒì¼: domain/services/strategy_compatibility_service.py
   class StrategyCompatibilityService:
       def check_trigger_compatibility(self, strategy: Strategy, trigger: Trigger) -> bool:
           """3ì¤‘ ì¹´í…Œê³ ë¦¬ í˜¸í™˜ì„± ê²€ì¦"""
           return self._check_comparison_group_compatibility(
               strategy.get_existing_variables(), trigger.variable
           )
   ```

2. **íŠ¸ë¦¬ê±° í‰ê°€ ì„œë¹„ìŠ¤**
   ```python
   # íŒŒì¼: domain/services/trigger_evaluation_service.py
   class TriggerEvaluationService:
       def evaluate_all_triggers(self, triggers: List[Trigger], 
                                market_data: MarketData) -> EvaluationResult:
           """ëª¨ë“  íŠ¸ë¦¬ê±° ì¡°ê±´ í‰ê°€"""
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **í˜¸í™˜ì„± ê²€ì¦ í…ŒìŠ¤íŠ¸**: ê¸°ë³¸ 7ê·œì¹™ ì „ëµì˜ ëª¨ë“  ì¡°í•© í…ŒìŠ¤íŠ¸
  ```python
  def test_7_rule_strategy_compatibility():
      # Given: ê¸°ë³¸ 7ê·œì¹™ ì „ëµ êµ¬ì„± ìš”ì†Œ
      rsi_trigger = create_rsi_oversold_trigger()
      profit_management = create_profit_taking_rule()
      
      # When: í˜¸í™˜ì„± ê²€ì¦
      result = compatibility_service.check_compatibility(rsi_trigger, profit_management)
      
      # Then: ëª¨ë“  ì¡°í•©ì´ í˜¸í™˜ë˜ì–´ì•¼ í•¨
      assert result.is_compatible
  ```

#### 1.3 Repository ì¸í„°í˜ì´ìŠ¤ ì •ì˜ (3ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ Repository ì¶”ìƒí™”**
   ```python
   # íŒŒì¼: domain/repositories/strategy_repository.py
   class StrategyRepository(ABC):
       @abstractmethod
       def save(self, strategy: Strategy) -> None:
           pass
           
       @abstractmethod
       def find_by_id(self, strategy_id: StrategyId) -> Optional[Strategy]:
           pass
   ```

2. **íŠ¸ë¦¬ê±° Repository ì¶”ìƒí™”**
   ```python
   # íŒŒì¼: domain/repositories/trigger_repository.py
   class TriggerRepository(ABC):
       @abstractmethod
       def save_trigger(self, trigger: Trigger) -> None:
           pass
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **ì¸í„°í˜ì´ìŠ¤ í…ŒìŠ¤íŠ¸**: Mockì„ ì‚¬ìš©í•œ Repository ë™ì‘ ê²€ì¦
  ```python
  def test_strategy_repository_interface():
      # Given
      mock_repo = Mock(spec=StrategyRepository)
      strategy = create_test_strategy()
      
      # When
      mock_repo.save(strategy)
      
      # Then
      mock_repo.save.assert_called_once_with(strategy)
  ```

#### 1.4 ë„ë©”ì¸ ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ (4ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ë„ë©”ì¸ ì´ë²¤íŠ¸ ì •ì˜**
   ```python
   # íŒŒì¼: domain/events/strategy_events.py
   @dataclass
   class StrategyCreated(DomainEvent):
       strategy_id: StrategyId
       created_at: datetime
       
   @dataclass
   class TriggerEvaluated(DomainEvent):
       trigger_id: TriggerId
       result: bool
       market_data_timestamp: datetime
   ```

2. **ì´ë²¤íŠ¸ ë°œí–‰ ë©”ì»¤ë‹ˆì¦˜**
   ```python
   # íŒŒì¼: domain/entities/strategy.py (ìˆ˜ì •)
   class Strategy:
       def add_trigger(self, trigger: Trigger) -> None:
           # ... ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ...
           self._domain_events.append(TriggerAdded(self.strategy_id, trigger.trigger_id))
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **ì´ë²¤íŠ¸ ë°œí–‰ í…ŒìŠ¤íŠ¸**:
  ```python
  def test_strategy_creation_event():
      # Given
      strategy_data = create_strategy_data()
      
      # When
      strategy = Strategy.create_new(strategy_data)
      
      # Then
      events = strategy.get_domain_events()
      assert len(events) == 1
      assert isinstance(events[0], StrategyCreated)
  ```

### **Phase 1 ì™„ë£Œ ê²€ì¦ ê¸°ì¤€**

#### UI ê²€ì¦ ì‹œë‚˜ë¦¬ì˜¤
í˜„ì¬ UIëŠ” ì•„ì§ ì—°ë™ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì´ ë‹¨ê³„ì—ì„œëŠ” ë„ë©”ì¸ ë¡œì§ë§Œ ê²€ì¦í•©ë‹ˆë‹¤.

#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê²€ì¦
```bash
# ì‹¤í–‰í•  í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´
pytest tests/domain/ -v --cov=upbit_auto_trading/domain --cov-report=html

# í†µê³¼í•´ì•¼ í•  í…ŒìŠ¤íŠ¸ë“¤
âœ… test_strategy_creation_with_valid_data
âœ… test_trigger_compatibility_validation  
âœ… test_7_rule_strategy_complete_workflow
âœ… test_domain_events_publishing
âœ… test_repository_interface_compliance
```

#### ê¸°ëŠ¥ ê²€ì¦ ì½”ë“œ
```python
# íŒŒì¼: tests/integration/test_phase1_integration.py
def test_phase1_complete_7_rule_strategy():
    """Phase 1 ì™„ë£Œ í›„ ê¸°ë³¸ 7ê·œì¹™ ì „ëµì´ ì™„ì „íˆ êµ¬í˜„ë˜ëŠ”ì§€ ê²€ì¦"""
    # Given: ê¸°ë³¸ 7ê·œì¹™ ì „ëµ êµ¬ì„± ìš”ì†Œ
    strategy_factory = StrategyFactory()
    
    # When: 7ê·œì¹™ ì „ëµ ìƒì„±
    strategy = strategy_factory.create_basic_7_rule_strategy()
    
    # Then: ëª¨ë“  ê·œì¹™ì´ ì˜¬ë°”ë¥´ê²Œ êµ¬ì„±ë˜ì–´ì•¼ í•¨
    assert len(strategy.entry_triggers) == 1  # RSI ê³¼ë§¤ë„ ì§„ì…
    assert len(strategy.exit_triggers) == 4   # 4ê°€ì§€ ì²­ì‚° ê·œì¹™
    assert len(strategy.management_rules) == 2 # ë¶ˆíƒ€ê¸°, ë¬¼íƒ€ê¸°
    
    # And: ëª¨ë“  ì¡°í•©ì´ í˜¸í™˜ë˜ì–´ì•¼ í•¨
    compatibility_service = StrategyCompatibilityService()
    assert compatibility_service.validate_strategy(strategy)
```

---

### Phase 2: Application Layer êµ¬ì¶• (2ì£¼)
**ëª©í‘œ**: Use Case ì¤‘ì‹¬ì˜ Application Serviceë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¡°ì •

#### 2.1 Application Service ì„¤ê³„ (4ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ ê´€ë¦¬ ì„œë¹„ìŠ¤**
   ```python
   # íŒŒì¼: application/services/strategy_application_service.py
   class StrategyApplicationService:
       def __init__(self, strategy_repo: StrategyRepository, 
                    compatibility_service: StrategyCompatibilityService,
                    event_bus: EventBus):
           self._strategy_repo = strategy_repo
           self._compatibility_service = compatibility_service
           self._event_bus = event_bus
       
       def create_strategy(self, command: CreateStrategyCommand) -> StrategyDto:
           """ì „ëµ ìƒì„± Use Case"""
           # 1. ì…ë ¥ ê²€ì¦
           self._validate_create_command(command)
           
           # 2. ë„ë©”ì¸ ê°ì²´ ìƒì„±
           strategy = Strategy.create_new(command.to_domain_data())
           
           # 3. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦
           if not self._compatibility_service.validate_strategy(strategy):
               raise StrategyValidationError()
           
           # 4. ì €ì¥
           self._strategy_repo.save(strategy)
           
           # 5. ì´ë²¤íŠ¸ ë°œí–‰
           self._event_bus.publish_all(strategy.get_domain_events())
           
           # 6. DTO ë°˜í™˜
           return StrategyDto.from_entity(strategy)
   ```

2. **íŠ¸ë¦¬ê±° ê´€ë¦¬ ì„œë¹„ìŠ¤**
   ```python
   # íŒŒì¼: application/services/trigger_application_service.py
   class TriggerApplicationService:
       def create_trigger(self, command: CreateTriggerCommand) -> TriggerDto:
           """íŠ¸ë¦¬ê±° ìƒì„± Use Case"""
           
       def validate_trigger_compatibility(self, 
                                        strategy_id: str, 
                                        trigger_data: dict) -> ValidationResult:
           """ì‹¤ì‹œê°„ í˜¸í™˜ì„± ê²€ì¦ Use Case"""
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **Use Case í…ŒìŠ¤íŠ¸**:
  ```python
  def test_create_strategy_use_case():
      # Given
      service = StrategyApplicationService(mock_repo, mock_compatibility, mock_event_bus)
      command = CreateStrategyCommand("RSI ì „ëµ", rsi_trigger_data)
      
      # When
      result = service.create_strategy(command)
      
      # Then
      assert result.strategy_id is not None
      assert result.name == "RSI ì „ëµ"
      mock_repo.save.assert_called_once()
  ```

#### 2.2 Command/Query íŒ¨í„´ êµ¬í˜„ (3ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **Command ê°ì²´ ì •ì˜**
   ```python
   # íŒŒì¼: application/commands/strategy_commands.py
   @dataclass
   class CreateStrategyCommand:
       name: str
       entry_triggers: List[Dict]
       exit_triggers: List[Dict]
       management_rules: List[Dict]
       
       def to_domain_data(self) -> StrategyCreationData:
           """ë„ë©”ì¸ ìƒì„± ë°ì´í„°ë¡œ ë³€í™˜"""
   ```

2. **Query ê°ì²´ ì •ì˜**
   ```python
   # íŒŒì¼: application/queries/strategy_queries.py
   @dataclass 
   class GetStrategyQuery:
       strategy_id: str
       
   @dataclass
   class SearchStrategiesQuery:
       name_pattern: Optional[str] = None
       tags: Optional[List[str]] = None
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **Command ê²€ì¦ í…ŒìŠ¤íŠ¸**:
  ```python
  def test_create_strategy_command_validation():
      # Given
      invalid_command = CreateStrategyCommand("", [], [], [])
      
      # When & Then
      with pytest.raises(ValidationError):
          invalid_command.validate()
  ```

#### 2.3 DTO ë° ë§¤í•‘ êµ¬í˜„ (4ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ DTO í´ë˜ìŠ¤**
   ```python
   # íŒŒì¼: application/dto/strategy_dto.py
   @dataclass
   class StrategyDto:
       strategy_id: str
       name: str
       entry_triggers: List[TriggerDto]
       exit_triggers: List[TriggerDto]
       created_at: datetime
       
       @classmethod
       def from_entity(cls, strategy: Strategy) -> 'StrategyDto':
           """ë„ë©”ì¸ ì—”í‹°í‹°ë¥¼ DTOë¡œ ë³€í™˜"""
   ```

2. **íŠ¸ë¦¬ê±° DTO í´ë˜ìŠ¤**
   ```python
   # íŒŒì¼: application/dto/trigger_dto.py
   @dataclass
   class TriggerDto:
       trigger_id: str
       variable_name: str
       operator: str
       target_value: Union[float, str]
       
       def to_domain_entity(self) -> Trigger:
           """DTOë¥¼ ë„ë©”ì¸ ì—”í‹°í‹°ë¡œ ë³€í™˜"""
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **ë§¤í•‘ ì •í™•ì„± í…ŒìŠ¤íŠ¸**:
  ```python
  def test_strategy_dto_mapping():
      # Given
      strategy = create_test_strategy()
      
      # When
      dto = StrategyDto.from_entity(strategy)
      reconstructed = dto.to_domain_entity()
      
      # Then
      assert reconstructed.strategy_id == strategy.strategy_id
      assert reconstructed.name == strategy.name
  ```

#### 2.4 ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ êµ¬í˜„ (3ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬**
   ```python
   # íŒŒì¼: application/event_handlers/strategy_event_handlers.py
   class StrategyEventHandler:
       def handle_strategy_created(self, event: StrategyCreated):
           """ì „ëµ ìƒì„± ì´ë²¤íŠ¸ ì²˜ë¦¬"""
           self._send_notification(f"ìƒˆ ì „ëµ ìƒì„±ë¨: {event.strategy_id}")
           
       def handle_trigger_evaluated(self, event: TriggerEvaluated):
           """íŠ¸ë¦¬ê±° í‰ê°€ ì´ë²¤íŠ¸ ì²˜ë¦¬"""
           if event.result:
               self._log_trigger_activation(event)
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **ì´ë²¤íŠ¸ í•¸ë“¤ë§ í…ŒìŠ¤íŠ¸**:
  ```python
  def test_strategy_created_event_handling():
      # Given
      handler = StrategyEventHandler()
      event = StrategyCreated(StrategyId("TEST_001"), datetime.now())
      
      # When
      handler.handle_strategy_created(event)
      
      # Then
      # ì•Œë¦¼ì´ ì „ì†¡ë˜ì—ˆëŠ”ì§€ ê²€ì¦
  ```

### **Phase 2 ì™„ë£Œ ê²€ì¦ ê¸°ì¤€**

#### UI ê²€ì¦ ì‹œë‚˜ë¦¬ì˜¤
ì´ ë‹¨ê³„ì—ì„œë„ ì•„ì§ UI ì—°ë™ì€ ì—†ìœ¼ë¯€ë¡œ Application Layer ê²€ì¦ì— ì§‘ì¤‘í•©ë‹ˆë‹¤.

#### í†µí•© í…ŒìŠ¤íŠ¸ ê²€ì¦
```bash
# ì‹¤í–‰í•  í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´
pytest tests/application/ -v --cov=upbit_auto_trading/application

# í†µê³¼í•´ì•¼ í•  í…ŒìŠ¤íŠ¸ë“¤
âœ… test_create_strategy_use_case_complete_flow
âœ… test_trigger_compatibility_validation_use_case
âœ… test_command_query_separation
âœ… test_dto_mapping_accuracy
âœ… test_event_handling_pipeline
```

#### ê¸°ëŠ¥ ê²€ì¦ ì½”ë“œ
```python
# íŒŒì¼: tests/integration/test_phase2_integration.py
def test_phase2_complete_application_layer():
    """Phase 2 ì™„ë£Œ í›„ Application Layerê°€ ì™„ì „íˆ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦"""
    # Given: ì˜ì¡´ì„± ì£¼ì… ì»¨í…Œì´ë„ˆ ì„¤ì •
    container = DependencyContainer()
    strategy_service = container.resolve(StrategyApplicationService)
    
    # When: ê¸°ë³¸ 7ê·œì¹™ ì „ëµ ìƒì„± Use Case ì‹¤í–‰
    command = CreateBasic7RuleStrategyCommand()
    result = strategy_service.create_strategy(command)
    
    # Then: ì •í™•í•œ ì‘ë‹µê³¼ ë¶€ìˆ˜ íš¨ê³¼ ê²€ì¦
    assert result.strategy_id is not None
    assert len(result.entry_triggers) == 1
    assert len(result.exit_triggers) == 4
    
    # And: ë„ë©”ì¸ ì´ë²¤íŠ¸ê°€ ë°œí–‰ë˜ì—ˆëŠ”ì§€ ê²€ì¦
    events = mock_event_bus.published_events
    assert any(isinstance(e, StrategyCreated) for e in events)
```

---

### Phase 3: Infrastructure Layer êµ¬í˜„ (2ì£¼)
**ëª©í‘œ**: Repository íŒ¨í„´ê³¼ ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™ ì™„ì„±

#### 3.1 Repository êµ¬í˜„ (5ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **SQLite ì „ëµ Repository**
   ```python
   # íŒŒì¼: infrastructure/repositories/sqlite_strategy_repository.py
   class SqliteStrategyRepository(StrategyRepository):
       def __init__(self, db_manager: DatabaseManager):
           self._db = db_manager
           
       def save(self, strategy: Strategy) -> None:
           """ì „ëµì„ strategies.sqlite3ì— ì €ì¥"""
           with self._db.get_connection('strategies') as conn:
               # ì „ëµ ë©”ì¸ ë°ì´í„° ì €ì¥
               conn.execute(
                   "INSERT INTO strategies (id, name, created_at) VALUES (?, ?, ?)",
                   (strategy.strategy_id.value, strategy.name, strategy.created_at)
               )
               
               # íŠ¸ë¦¬ê±° ë°ì´í„° ì €ì¥
               for trigger in strategy.get_all_triggers():
                   conn.execute(
                       "INSERT INTO strategy_triggers (strategy_id, trigger_id, ...) VALUES (?, ?, ...)",
                       trigger.to_database_params()
                   )
   ```

2. **ì„¤ì • Repository (ì½ê¸° ì „ìš©)**
   ```python
   # íŒŒì¼: infrastructure/repositories/settings_repository.py
   class SettingsRepository:
       def get_trading_variables(self) -> List[TradingVariable]:
           """settings.sqlite3ì—ì„œ ë§¤ë§¤ ë³€ìˆ˜ ì •ì˜ ë¡œë“œ"""
           
       def get_compatibility_rules(self) -> CompatibilityRules:
           """í˜¸í™˜ì„± ê·œì¹™ ë¡œë“œ"""
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **Repository í†µí•© í…ŒìŠ¤íŠ¸**:
  ```python
  def test_sqlite_strategy_repository_roundtrip():
      # Given
      repo = SqliteStrategyRepository(test_db_manager)
      strategy = create_test_strategy()
      
      # When
      repo.save(strategy)
      loaded_strategy = repo.find_by_id(strategy.strategy_id)
      
      # Then
      assert loaded_strategy is not None
      assert loaded_strategy.name == strategy.name
      assert len(loaded_strategy.entry_triggers) == len(strategy.entry_triggers)
  ```

#### 3.2 ì™¸ë¶€ API í´ë¼ì´ì–¸íŠ¸ (4ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **Upbit API í´ë¼ì´ì–¸íŠ¸**
   ```python
   # íŒŒì¼: infrastructure/external_apis/upbit_client.py
   class UpbitApiClient:
       def __init__(self, api_config: ApiConfig):
           self._config = api_config
           
       async def get_market_data(self, symbol: str, timeframe: str) -> MarketData:
           """ì‹œì¥ ë°ì´í„° ì¡°íšŒ"""
           
       async def place_order(self, order_request: OrderRequest) -> OrderResult:
           """ì£¼ë¬¸ ì‹¤í–‰"""
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **API í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸** (Mock ì‚¬ìš©):
  ```python
  @pytest.mark.asyncio
  async def test_upbit_client_market_data():
      # Given
      mock_response = create_mock_market_data_response()
      client = UpbitApiClient(test_config)
      
      # When
      with patch('aiohttp.ClientSession.get') as mock_get:
          mock_get.return_value.__aenter__.return_value.json.return_value = mock_response
          result = await client.get_market_data("KRW-BTC", "1h")
      
      # Then
      assert result.symbol == "KRW-BTC"
      assert len(result.candles) > 0
  ```

#### 3.3 ì´ë²¤íŠ¸ ë²„ìŠ¤ êµ¬í˜„ (3ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì¸ë©”ëª¨ë¦¬ ì´ë²¤íŠ¸ ë²„ìŠ¤**
   ```python
   # íŒŒì¼: infrastructure/messaging/in_memory_event_bus.py
   class InMemoryEventBus(EventBus):
       def __init__(self):
           self._handlers: Dict[Type[DomainEvent], List[EventHandler]] = {}
           
       def subscribe(self, event_type: Type[DomainEvent], handler: EventHandler):
           """ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡"""
           
       async def publish(self, event: DomainEvent):
           """ì´ë²¤íŠ¸ ë°œí–‰"""
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **ì´ë²¤íŠ¸ ë²„ìŠ¤ í…ŒìŠ¤íŠ¸**:
  ```python
  @pytest.mark.asyncio
  async def test_event_bus_publish_subscribe():
      # Given
      bus = InMemoryEventBus()
      handler = Mock()
      event = StrategyCreated(StrategyId("TEST"))
      
      # When
      bus.subscribe(StrategyCreated, handler)
      await bus.publish(event)
      
      # Then
      handler.handle.assert_called_once_with(event)
  ```

#### 3.4 ì„¤ì • ê´€ë¦¬ ê°œì„  (2ì¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì˜ì¡´ì„± ì£¼ì… ì»¨í…Œì´ë„ˆ**
   ```python
   # íŒŒì¼: infrastructure/config/dependency_container.py
   class DependencyContainer:
       def __init__(self):
           self._services = {}
           self._configure_dependencies()
           
       def resolve(self, service_type: Type[T]) -> T:
           """ì„œë¹„ìŠ¤ í•´ê²°"""
   ```

### **Phase 3 ì™„ë£Œ ê²€ì¦ ê¸°ì¤€**

#### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê²€ì¦
```bash
pytest tests/infrastructure/ -v --cov=upbit_auto_trading/infrastructure

# í†µê³¼í•´ì•¼ í•  í…ŒìŠ¤íŠ¸ë“¤
âœ… test_sqlite_repository_operations
âœ… test_upbit_api_client_integration  
âœ… test_event_bus_reliability
âœ… test_dependency_injection_container
```

#### í†µí•© í…ŒìŠ¤íŠ¸ ê²€ì¦
```python
def test_phase3_complete_infrastructure():
    """Phase 3 ì™„ë£Œ í›„ Infrastructureê°€ ì™„ì „íˆ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦"""
    # Given: ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™ëœ Repository
    container = DependencyContainer()
    strategy_service = container.resolve(StrategyApplicationService)
    
    # When: ì „ëµ ìƒì„±ë¶€í„° ì €ì¥ê¹Œì§€ ì „ì²´ í”Œë¡œìš° ì‹¤í–‰
    command = CreateBasic7RuleStrategyCommand()
    result = strategy_service.create_strategy(command)
    
    # Then: ë°ì´í„°ë² ì´ìŠ¤ì— ì‹¤ì œë¡œ ì €ì¥ë˜ì—ˆëŠ”ì§€ ê²€ì¦
    saved_strategy = container.resolve(StrategyRepository).find_by_id(result.strategy_id)
    assert saved_strategy is not None
    
    # And: ì„¤ì • ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œë˜ëŠ”ì§€ ê²€ì¦
    settings_repo = container.resolve(SettingsRepository)
    variables = settings_repo.get_trading_variables()
    assert len(variables) > 0
```

---

### Phase 4: Presentation Layer ë¦¬íŒ©í† ë§ (3ì£¼)
**ëª©í‘œ**: MVP íŒ¨í„´ ì ìš©ìœ¼ë¡œ UIë¥¼ ì™„ì „íˆ ìˆ˜ë™ì (Passive)ìœ¼ë¡œ ë§Œë“¤ê¸°

#### 4.1 Presenter êµ¬í˜„ (1ì£¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì „ëµ ë©”ì´ì»¤ Presenter**
   ```python
   # íŒŒì¼: presentation/presenters/strategy_maker_presenter.py
   class StrategyMakerPresenter:
       def __init__(self, view: StrategyMakerView, 
                    strategy_service: StrategyApplicationService):
           self._view = view
           self._strategy_service = strategy_service
           self._setup_view_bindings()
           
       def on_save_strategy_clicked(self, strategy_data: dict):
           """ì „ëµ ì €ì¥ ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬"""
           try:
               command = CreateStrategyCommand.from_view_data(strategy_data)
               result = self._strategy_service.create_strategy(command)
               self._view.show_success_message(f"ì „ëµ '{result.name}' ì €ì¥ ì™„ë£Œ")
               self._view.clear_form()
           except ValidationError as e:
               self._view.show_validation_errors(e.errors)
           except Exception as e:
               self._view.show_error_message(f"ì €ì¥ ì‹¤íŒ¨: {str(e)}")
   ```

2. **íŠ¸ë¦¬ê±° ë¹Œë” Presenter**
   ```python
   # íŒŒì¼: presentation/presenters/trigger_builder_presenter.py
   class TriggerBuilderPresenter:
       def on_variable_selected(self, variable_name: str):
           """ë³€ìˆ˜ ì„ íƒ ì‹œ í˜¸í™˜ì„± ê²€ì¦ ë° UI ì—…ë°ì´íŠ¸"""
           compatible_variables = self._trigger_service.get_compatible_variables(variable_name)
           self._view.update_variable_list(compatible_variables)
           
       def on_create_condition_clicked(self, condition_data: dict):
           """ì¡°ê±´ ìƒì„± ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬"""
           validation_result = self._trigger_service.validate_condition(condition_data)
           if validation_result.is_valid:
               self._view.add_condition_card(condition_data)
           else:
               self._view.show_validation_warnings(validation_result.warnings)
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **Presenter ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**:
  ```python
  def test_strategy_maker_presenter_save_success():
      # Given
      mock_view = Mock(spec=StrategyMakerView)
      mock_service = Mock(spec=StrategyApplicationService)
      presenter = StrategyMakerPresenter(mock_view, mock_service)
      
      strategy_data = {"name": "í…ŒìŠ¤íŠ¸ ì „ëµ", "triggers": []}
      mock_service.create_strategy.return_value = StrategyDto("ID_001", "í…ŒìŠ¤íŠ¸ ì „ëµ", [])
      
      # When
      presenter.on_save_strategy_clicked(strategy_data)
      
      # Then
      mock_view.show_success_message.assert_called_once()
      mock_view.clear_form.assert_called_once()
  ```

#### 4.2 View ë¦¬íŒ©í† ë§ (1ì£¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **Passive Viewë¡œ ì „í™˜**
   ```python
   # íŒŒì¼: presentation/desktop/views/strategy_maker_view.py
   class StrategyMakerView(QWidget):
       def __init__(self, presenter: StrategyMakerPresenter):
           super().__init__()
           self._presenter = presenter
           self._setup_ui()
           
       def _setup_ui(self):
           """UI êµ¬ì„± (í‘œì‹œë§Œ ë‹´ë‹¹)"""
           self._name_input = QLineEdit()
           self._save_button = QPushButton("ì €ì¥")
           self._save_button.clicked.connect(self._on_save_clicked)
           
       def _on_save_clicked(self):
           """ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ Presenterì— ìœ„ì„"""
           strategy_data = self._collect_form_data()
           self._presenter.on_save_strategy_clicked(strategy_data)
           
       def show_success_message(self, message: str):
           """ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ (Presenterì—ì„œ í˜¸ì¶œ)"""
           QMessageBox.information(self, "ì„±ê³µ", message)
           
       def show_validation_errors(self, errors: List[str]):
           """ê²€ì¦ ì˜¤ë¥˜ í‘œì‹œ (Presenterì—ì„œ í˜¸ì¶œ)"""
           error_text = "\n".join(errors)
           QMessageBox.warning(self, "ì…ë ¥ ì˜¤ë¥˜", error_text)
   ```

**ê²€ì¦ ë°©ì•ˆ**:
- **View í…ŒìŠ¤íŠ¸** (PyQt6 í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ì‚¬ìš©):
  ```python
  def test_strategy_maker_view_user_interaction():
      # Given
      mock_presenter = Mock()
      view = StrategyMakerView(mock_presenter)
      
      # When
      view._name_input.setText("í…ŒìŠ¤íŠ¸ ì „ëµ")
      QTest.mouseClick(view._save_button, Qt.LeftButton)
      
      # Then
      mock_presenter.on_save_strategy_clicked.assert_called_once()
  ```

#### 4.3 ì´ë²¤íŠ¸ ê¸°ë°˜ UI ê°±ì‹  (1ì£¼)

**êµ¬ì²´ì  ì‘ì—…**:
1. **ì‹¤ì‹œê°„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸**
   ```python
   # íŒŒì¼: presentation/desktop/components/mini_chart_component.py
   class MiniChartComponent(QWidget):
       def __init__(self, chart_presenter: ChartPresenter):
           super().__init__()
           self._presenter = chart_presenter
           self._presenter.data_updated.connect(self._on_data_updated)
           
       def _on_data_updated(self, chart_data: ChartData):
           """ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸ (Presenterì—ì„œ ì‹ í˜¸ ë°œìƒ)"""
           self._update_chart_display(chart_data)
   ```

2. **ì‹¤ì‹œê°„ í˜¸í™˜ì„± ê²€ì¦ UI**
   ```python
   # íŒŒì¼: presentation/desktop/views/trigger_builder_view.py
   class TriggerBuilderView(QWidget):
       def _on_variable_changed(self):
           """ë³€ìˆ˜ ë³€ê²½ ì‹œ ì‹¤ì‹œê°„ í˜¸í™˜ì„± ê²€ì¦"""
           selected_variable = self._variable_combo.currentText()
           self._presenter.on_variable_selected(selected_variable)
           
       def update_compatibility_status(self, is_compatible: bool, warnings: List[str]):
           """í˜¸í™˜ì„± ìƒíƒœ UI ì—…ë°ì´íŠ¸"""
           if is_compatible:
               self._status_label.setText("âœ… í˜¸í™˜ ê°€ëŠ¥")
               self._status_label.setStyleSheet("color: green;")
           else:
               self._status_label.setText("âŒ í˜¸í™˜ ë¶ˆê°€")
               self._status_label.setStyleSheet("color: red;")
   ```

### **Phase 4 ì™„ë£Œ ê²€ì¦ ê¸°ì¤€**

#### UI ê²€ì¦ ì‹œë‚˜ë¦¬ì˜¤ (ìµœì¢… í†µí•© í…ŒìŠ¤íŠ¸)
ì´ì œ `run_desktop_ui.py`ë¥¼ ì‹¤í–‰í•˜ì—¬ ì „ì²´ ì‹œìŠ¤í…œì„ ê²€ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸°ë³¸ 7ê·œì¹™ ì „ëµ ìƒì„±**
```
1. `python run_desktop_ui.py` ì‹¤í–‰
2. "ì „ëµ ê´€ë¦¬" íƒ­ìœ¼ë¡œ ì´ë™
3. "ìƒˆ ì „ëµ ë§Œë“¤ê¸°" ë²„íŠ¼ í´ë¦­
4. ì „ëµ ì´ë¦„: "ê¸°ë³¸ 7ê·œì¹™ í…ŒìŠ¤íŠ¸"
5. íŠ¸ë¦¬ê±° ë¹Œë”ì—ì„œ ë‹¤ìŒ ìˆœì„œë¡œ êµ¬ì„±:
   - RSI(14) < 30 (ì§„ì… ì¡°ê±´)
   - ìˆ˜ìµë¥  > 5% (ë¶ˆíƒ€ê¸° ì¡°ê±´) 
   - ìˆ˜ìµë¥  < -5% (ë¬¼íƒ€ê¸° ì¡°ê±´)
   - ê¸‰ë½ ê°ì§€ (ë¹„ìƒ ì²­ì‚°)
6. "ì €ì¥" ë²„íŠ¼ í´ë¦­
7. ì„±ê³µ ë©”ì‹œì§€ í™•ì¸: "ì „ëµ 'ê¸°ë³¸ 7ê·œì¹™ í…ŒìŠ¤íŠ¸' ì €ì¥ ì™„ë£Œ"
8. ì „ëµ ëª©ë¡ì—ì„œ ì €ì¥ëœ ì „ëµ í™•ì¸
9. data/strategies.sqlite3 íŒŒì¼ì— ë°ì´í„° ì €ì¥ í™•ì¸
```

**ì‹œë‚˜ë¦¬ì˜¤ 2: í˜¸í™˜ì„± ê²€ì¦**
```
1. íŠ¸ë¦¬ê±° ë¹Œë”ì—ì„œ RSI ì§€í‘œ ì„ íƒ
2. ë¹„êµ ëŒ€ìƒìœ¼ë¡œ MACD ì„ íƒ ì‹œë„
3. ê²½ê³  ë©”ì‹œì§€ í™•ì¸: "RSIì™€ MACDëŠ” í˜¸í™˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
4. ë¹„êµ ëŒ€ìƒ ì„ íƒë€ì—ì„œ MACDê°€ ë¹„í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
5. í˜¸í™˜ ê°€ëŠ¥í•œ Stochastic ì„ íƒ ì‹œ ì •ìƒ ë™ì‘ í™•ì¸
```

**ì‹œë‚˜ë¦¬ì˜¤ 3: ì‹¤ì‹œê°„ ì‹œë®¬ë ˆì´ì…˜**
```
1. ìƒì„±ëœ ì „ëµ ì„ íƒ
2. "ë°±í…ŒìŠ¤íŒ…" ë²„íŠ¼ í´ë¦­  
3. ì‹œë®¬ë ˆì´ì…˜ ì§„í–‰ ìƒí™©ì„ ë¯¸ë‹ˆ ì°¨íŠ¸ì—ì„œ í™•ì¸
4. ê²°ê³¼ ë¦¬í¬íŠ¸ ìƒì„± í™•ì¸
5. ì„±ëŠ¥ ì§€í‘œ (ìˆ˜ìµë¥ , ìƒ¤í”„ë¹„ìœ¨ ë“±) í‘œì‹œ í™•ì¸
```

#### ìµœì¢… í†µí•© í…ŒìŠ¤íŠ¸
```python
# íŒŒì¼: tests/integration/test_complete_system.py
def test_complete_7_rule_strategy_workflow():
    """ì „ì²´ ì‹œìŠ¤í…œì—ì„œ ê¸°ë³¸ 7ê·œì¹™ ì „ëµ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸"""
    # Given: ì™„ì „íˆ êµ¬ì„±ëœ ì‹œìŠ¤í…œ
    container = DependencyContainer()
    
    # When: UI ì—†ì´ ì „ì²´ í”Œë¡œìš° ì‹¤í–‰
    strategy_service = container.resolve(StrategyApplicationService)
    trigger_service = container.resolve(TriggerApplicationService)
    backtest_service = container.resolve(BacktestApplicationService)
    
    # 1. ì „ëµ ìƒì„±
    strategy_result = strategy_service.create_strategy(CreateBasic7RuleStrategyCommand())
    
    # 2. ë°±í…ŒìŠ¤íŒ… ì‹¤í–‰
    backtest_result = backtest_service.run_backtest(
        strategy_result.strategy_id, 
        "KRW-BTC", 
        "2024-01-01", 
        "2024-12-31"
    )
    
    # Then: ëª¨ë“  ë‹¨ê³„ê°€ ì •ìƒ ë™ì‘
    assert strategy_result.strategy_id is not None
    assert backtest_result.total_return is not None
    assert backtest_result.max_drawdown is not None
    assert backtest_result.sharpe_ratio is not None
    
    # And: 7ê·œì¹™ì´ ëª¨ë‘ ì‹¤í–‰ë˜ì—ˆëŠ”ì§€ ê²€ì¦
    execution_logs = backtest_result.execution_logs
    assert any("RSI ê³¼ë§¤ë„ ì§„ì…" in log.action for log in execution_logs)
    assert any("ë¶ˆíƒ€ê¸°" in log.action for log in execution_logs)
    assert any("ë¬¼íƒ€ê¸°" in log.action for log in execution_logs)
```

#### ì„±ëŠ¥ ê²€ì¦
```bash
# ë°±í…ŒìŠ¤íŒ… ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
pytest tests/performance/test_backtest_performance.py

# í™•ì¸í•´ì•¼ í•  ì„±ëŠ¥ ì§€í‘œ
âœ… 1ë…„ ë¶„ë´‰ ë°ì´í„° ë°±í…ŒìŠ¤íŒ…: 5ë¶„ ë‚´ ì™„ë£Œ
âœ… UI ì‘ë‹µì„±: ëª¨ë“  ë²„íŠ¼ í´ë¦­ 100ms ë‚´ ë°˜ì‘
âœ… ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: 2GB ì´í•˜ ìœ ì§€
âœ… ì „ëµ ì €ì¥: 1ì´ˆ ë‚´ ì™„ë£Œ
```

---

## ğŸ¯ ë¦¬íŒ©í† ë§ ì„±ê³µ ì§€í‘œ

### ì •ëŸ‰ì  ì§€í‘œ
- **ì½”ë“œ ë³µì¡ë„**: í˜„ì¬ í‰ê·  15 â†’ ëª©í‘œ 8 ì´í•˜
- **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€**: í˜„ì¬ 30% â†’ ëª©í‘œ 80% ì´ìƒ  
- **UI ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**: í˜„ì¬ 60% â†’ ëª©í‘œ 5% ì´í•˜
- **ìˆœí™˜ ì˜ì¡´ì„±**: í˜„ì¬ 8ê°œ â†’ ëª©í‘œ 0ê°œ
- **ë°±í…ŒìŠ¤íŒ… ì„±ëŠ¥**: 1ë…„ ë¶„ë´‰ ë°ì´í„° 5ë¶„ ë‚´ ì²˜ë¦¬ ìœ ì§€

### ì •ì„±ì  ì§€í‘œ
- **ê°€ë…ì„±**: ìƒˆë¡œìš´ ê°œë°œìê°€ 1ì£¼ ë‚´ ì½”ë“œ êµ¬ì¡° ì´í•´ ê°€ëŠ¥
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ ì „ëµ ì¶”ê°€ê°€ 2ì‹œê°„ ë‚´ ì™„ë£Œ ê°€ëŠ¥
- **í…ŒìŠ¤íŠ¸ ìš©ì´ì„±**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- **ìœ ì§€ë³´ìˆ˜ì„±**: ë³€ê²½ ì‚¬í•­ì˜ ì˜í–¥ ë²”ìœ„ê°€ ëª…í™•íˆ ì˜ˆì¸¡ ê°€ëŠ¥

---

## ğŸš¨ ìœ„í—˜ ê´€ë¦¬ ë° ë¡¤ë°± ê³„íš

### ì£¼ìš” ìœ„í—˜ ìš”ì†Œ
1. **ë°ì´í„° ì†ì‹¤**: ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘ ì „ëµ/í¬ì§€ì…˜ ë°ì´í„° ì†ì‹¤
2. **ê¸°ëŠ¥ í‡´í™”**: ë¦¬íŒ©í† ë§ìœ¼ë¡œ ì¸í•œ ê¸°ì¡´ ê¸°ëŠ¥ ë™ì‘ ë³€ê²½
3. **ì„±ëŠ¥ ì €í•˜**: ê³„ì¸µ ë¶„ë¦¬ë¡œ ì¸í•œ ì˜¤ë²„í—¤ë“œ
4. **ê°œë°œ ì§€ì—°**: ì˜ˆìƒë³´ë‹¤ ë³µì¡í•œ ì˜ì¡´ì„± í•´ê²°

### ìœ„í—˜ ì™„í™” ì „ëµ
1. **ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜**: 
   - Big Bang ë°©ì‹ ì§€ì–‘
   - ê° Phaseë³„ ë…ë¦½ì  ê²€ì¦
   - ê¸°ì¡´ ì½”ë“œì™€ ìƒˆ ì½”ë“œ ê³µì¡´ ê¸°ê°„ ìµœì†Œí™”

2. **ë°ì´í„° ë°±ì—…**:
   ```bash
   # ê° Phase ì‹œì‘ ì „ í•„ìˆ˜ ë°±ì—…
   cp data/strategies.sqlite3 data/backups/strategies_phase1_backup.sqlite3
   cp data/settings.sqlite3 data/backups/settings_phase1_backup.sqlite3
   ```

3. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**:
   - ê° Phase ì™„ë£Œ í›„ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
   - ì„±ëŠ¥ ì €í•˜ 10% ì´ˆê³¼ ì‹œ ìµœì í™” ì‘ì—… ì¶”ê°€

4. **ë¡¤ë°± ì‹œë‚˜ë¦¬ì˜¤**:
   ```bash
   # Phase ì‹¤íŒ¨ ì‹œ ë¡¤ë°± ìŠ¤í¬ë¦½íŠ¸
   git checkout phase_backup_branch
   cp data/backups/* data/
   python scripts/verify_rollback.py
   ```

---

## ğŸ“š íŒ€ ì¤€ë¹„ì‚¬í•­

### í•„ìˆ˜ í•™ìŠµ ìë£Œ
1. **Clean Architecture**: Uncle Bobì˜ Clean Architecture ê°œë…
2. **MVP íŒ¨í„´**: PyQt6ì—ì„œì˜ MVP íŒ¨í„´ êµ¬í˜„
3. **Repository íŒ¨í„´**: ë°ì´í„° ì ‘ê·¼ ì¶”ìƒí™”
4. **Domain Driven Design**: ë„ë©”ì¸ ëª¨ë¸ë§ ê¸°ë²•

### ê°œë°œ í™˜ê²½ ì„¤ì •
```bash
# í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜
pip install pytest pytest-cov pytest-mock
pip install mypy black isort
pip install sqlalchemy alembic  # ë§ˆì´ê·¸ë ˆì´ì…˜ìš©

# í…ŒìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
python scripts/setup_test_databases.py
```

### ì½”ë“œ ë¦¬ë·° ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ Domain Layerì— ìœ„ì¹˜
- [ ] UI ì»´í¬ë„ŒíŠ¸ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—†ìŒ
- [ ] Repository ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ë°ì´í„° ì ‘ê·¼
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 80% ì´ìƒ
- [ ] ìˆœí™˜ ì˜ì¡´ì„± ì—†ìŒ

---

## ğŸ‰ ë¦¬íŒ©í† ë§ ì™„ë£Œ í›„ ê¸°ëŒ€ íš¨ê³¼

### ê°œë°œ ìƒì‚°ì„± í–¥ìƒ
- **ìƒˆ ì „ëµ ê°œë°œ**: 2ì‹œê°„ ë‚´ ì™„ë£Œ (ê¸°ì¡´ 1-2ì¼)
- **ë²„ê·¸ ìˆ˜ì •**: ì˜í–¥ ë²”ìœ„ ëª…í™•í™”ë¡œ 50% ì‹œê°„ ë‹¨ì¶•
- **í…ŒìŠ¤íŠ¸ ì‘ì„±**: ëª¨ë“  ë¡œì§ì´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•´ì ¸ í’ˆì§ˆ í–¥ìƒ

### ì‹œìŠ¤í…œ ì•ˆì •ì„± í™•ë³´
- **ì‹¤ì œ ìê¸ˆ ìš´ìš© ê°€ëŠ¥**: ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ì™€ ê²€ì¦ìœ¼ë¡œ ì‹ ë¢°ì„± í™•ë³´
- **í™•ì¥ì„±**: í–¥í›„ ìƒˆë¡œìš´ ê±°ë˜ì†Œ ì¶”ê°€ ìš©ì´
- **ìœ ì§€ë³´ìˆ˜ì„±**: ì½”ë“œ ë³€ê²½ ì‹œ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì˜í–¥ ë²”ìœ„

### ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- **ë¹ ë¥¸ ì‘ë‹µì„±**: UIì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë¶„ë¦¬ë¡œ ì„±ëŠ¥ ìµœì í™”
- **ì§ê´€ì  ì¸í„°í˜ì´ìŠ¤**: ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬ë¡œ ì¼ê´€ëœ UX
- **ì•ˆì •ì  ë™ì‘**: ì˜ˆì™¸ ìƒí™© ì²˜ë¦¬ ê°œì„ ìœ¼ë¡œ í¬ë˜ì‹œ ìµœì†Œí™”

---

**ğŸ’¡ í•µì‹¬ ë©”ì‹œì§€**: "ë‹¨ê³„ë³„ ì ì§„ì  ë¦¬íŒ©í† ë§ì„ í†µí•´ ì•ˆì „í•˜ê³  í™•ì‹¤í•œ ì•„í‚¤í…ì²˜ ê°œì„ ì„ ë‹¬ì„±í•œë‹¤!"

**ğŸ¯ ìµœì¢… ëª©í‘œ**: ì‹¤ì œ ìê¸ˆ ìš´ìš©ì´ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ ì•ˆì •ì ì´ê³  í™•ì¥ ê°€ëŠ¥í•œ ìë™ë§¤ë§¤ ì‹œìŠ¤í…œ ì™„ì„±

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„ Action Items

### ì¦‰ì‹œ ì‹œì‘ (ì´ë²ˆ ì£¼)
1. **íŒ€ ë¸Œë¦¬í•‘**: ë³¸ ë¬¸ì„œ ë‚´ìš© ì „ì²´ íŒ€ ê²€í† 
2. **ê°œë°œ í™˜ê²½ ì¤€ë¹„**: í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜ ë° í…ŒìŠ¤íŠ¸ DB êµ¬ì„±
3. **Phase 1 ìƒì„¸ ê³„íš**: Domain Layer êµ¬ì¶• íƒœìŠ¤í¬ ì„¸ë¶„í™”

### 1ì£¼ ë‚´ ì™„ë£Œ
1. **íƒœìŠ¤í¬ ìƒì„±**: GitHub Issuesë¡œ ê° Phaseë³„ ìƒì„¸ íƒœìŠ¤í¬ ìƒì„±
2. **ë‹´ë‹¹ì ë°°ì •**: ê° ê°œë°œìë³„ ì—­í• ê³¼ ì±…ì„ í• ë‹¹
3. **ë§ˆì¼ìŠ¤í†¤ ì„¤ì •**: ê° Phaseë³„ ì™„ë£Œ ê¸°ì¤€ê³¼ ì¼ì • í™•ì •

### ì§€ì†ì  ëª¨ë‹ˆí„°ë§
1. **ì£¼ê°„ ë¦¬ë·°**: ë§¤ì£¼ ì§„í–‰ ìƒí™©ê³¼ ì´ìŠˆ ì ê²€
2. **í’ˆì§ˆ ì²´í¬**: ì½”ë“œ ë¦¬ë·°ì™€ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ëª¨ë‹ˆí„°ë§
3. **ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬**: ê° Phaseë³„ ì„±ëŠ¥ ì§€í‘œ ì¸¡ì • ë° ê¸°ë¡
