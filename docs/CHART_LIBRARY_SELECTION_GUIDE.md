# 차트 라이브러리 선택 가이드

## 🚨 PyQtGraph 사용 시 발생한 문제점

### 현재 프로젝트에서 겪은 주요 이슈들:
1. **무한 차트 업데이트 루프**: 지표 추가/제거 시 끝없는 재렌더링 발생
2. **자동 범위 조정 문제**: `disableAutoRange()` 적용해도 뷰포트 제어 어려움
3. **복잡한 상태 관리**: 지표 오버레이, 뷰포트 보존 등의 상태 동기화 복잡
4. **메모리 누수 위험**: Scene 아이템 제거 시 완전한 정리 어려움
5. **디버깅 어려움**: 내부 동작이 복잡해 문제 원인 파악 어려움

### 토큰 소모량: 상당히 많음 (근본적 해결 실패)

---

## 📈 추천 대안 라이브러리

### 1. **mplfinance** (Matplotlib 기반) ⭐⭐⭐⭐⭐
```python
import mplfinance as mpf
import pandas as pd

# 간단한 캔들스틱 차트
mpf.plot(df, type='candle', style='charles', volume=True)

# 이동평균선 추가
mpf.plot(df, type='candle', mav=(5,20,60), volume=True)
```

**장점:**
- ✅ **매우 간단한 코드**: 몇 줄로 전문적인 차트 완성
- ✅ **안정성 검증됨**: Matplotlib 기반으로 오랜 기간 검증
- ✅ **금융 차트 특화**: 캔들스틱, 거래량, 지표 최적화
- ✅ **높은 커스터마이징**: 색상, 스타일, 라벨 세밀 제어
- ✅ **메모리 효율성**: 정적 이미지 생성으로 메모리 안정

**단점:**
- ❌ 실시간 인터랙션이 PyQtGraph보다 부드럽지 않음

**추천 상황:** 정적 차트, 보고서용 차트, 백테스팅 결과 시각화

---

### 2. **Plotly** ⭐⭐⭐⭐⭐
```python
import plotly.graph_objects as go
from plotly.subplots import make_subplots

# 인터랙티브 캔들스틱 차트
fig = go.Figure(data=go.Candlestick(
    x=df.index,
    open=df['open'],
    high=df['high'],
    low=df['low'],
    close=df['close']
))
fig.show()
```

**장점:**
- ✅ **뛰어난 인터랙션**: 마우스 오버, 줌/패닝, 버튼 제어
- ✅ **웹 기반**: HTML 저장, 웹앱 통합 용이
- ✅ **세련된 디자인**: 기본 디자인이 전문적
- ✅ **실시간 업데이트 지원**: WebSocket 연동 가능
- ✅ **다양한 차트 타입**: 캔들스틱, 라인, 히트맵 등

**단점:**
- ❌ 대용량 실시간 데이터 처리 시 성능 이슈 가능

**추천 상황:** 대화형 대시보드, 웹 공유, 사용자 인터랙션 중요한 경우

---

### 3. **lightweight-charts** (TradingView 스타일) ⭐⭐⭐⭐⭐
```python
from lightweight_charts import Chart

chart = Chart()
chart.set(df)
chart.show(block=True)
```

**장점:**
- ✅ **TradingView 수준 UI/UX**: 최고의 사용자 경험
- ✅ **실시간 특화**: 실시간 가격 업데이트 최적화
- ✅ **빠른 성능**: 브라우저 기반 고성능 렌더링
- ✅ **간단한 사용법**: 복잡한 기능 대비 쉬운 구현

**단점:**
- ❌ 커스터마이징 자유도 상대적으로 낮음
- ❌ 웹 브라우저 의존성

**추천 상황:** 실시간 트레이딩 인터페이스, 전문 거래 시스템

---

## 🛠️ 향후 개발 전략

### 백테스팅 시스템 개발 시:
1. **1순위: mplfinance** - 백테스팅 결과 리포트에 최적
2. **2순위: Plotly** - 인터랙티브 분석이 필요한 경우

### 실시간 트레이딩 시스템 개발 시:
1. **1순위: lightweight-charts** - TradingView 수준 경험
2. **2순위: Plotly** - 웹 기반 대시보드

### 현재 프로젝트 리팩토링:
- PyQtGraph 차트 부분을 **mplfinance**로 교체 검토
- 무한 루프 문제 근본 해결 가능
- 개발 시간 대폭 단축 예상

---

## 📝 교훈

1. **라이브러리 선택의 중요성**: 초기 선택이 전체 개발에 미치는 영향 큼
2. **문제 복잡도 고려**: PyQtGraph는 고급 사용 시 복잡도 급격히 증가
3. **목적에 맞는 도구**: 금융 차트에는 금융 특화 라이브러리가 유리
4. **시간 비용**: 복잡한 문제 해결보다 적절한 도구 선택이 효율적

---

## ⚠️ 중요 결정사항

**현재 PyQtGraph 기반 차트 시스템은 안정성 문제로 인해 향후 대체 검토 필요**

**백테스팅 개발 시에는 반드시 위 추천 라이브러리 중 선택하여 개발할 것**
